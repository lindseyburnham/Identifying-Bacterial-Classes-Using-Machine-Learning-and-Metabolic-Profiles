<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lindsey Burnham">

<title>Code for Identifying Bacterial Class</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Quartz file for project_files/libs/clipboard/clipboard.min.js"></script>
<script src="Quartz file for project_files/libs/quarto-html/quarto.js"></script>
<script src="Quartz file for project_files/libs/quarto-html/popper.min.js"></script>
<script src="Quartz file for project_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Quartz file for project_files/libs/quarto-html/anchor.min.js"></script>
<link href="Quartz file for project_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Quartz file for project_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Quartz file for project_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Quartz file for project_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Quartz file for project_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Code for Identifying Bacterial Class</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Lindsey Burnham </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>For this documentation of the code I used, I will use a smaller dataset as the datasets used were many GBs.</p>
<p>First, we need to load in the datasets from MS-DIAL and normalize them. When working with large datasets, I consistently saved filtered data in a separate csv along the process so that I did not run out of storage on r.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#my ms data as an example</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>aligned_df<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"~/Desktop/biochem csvs/aligned_msdata.csv"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>filt_aligned<span class="ot">&lt;-</span>aligned_df<span class="sc">|&gt;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Alignment.ID, <span class="sc">-</span>Average.Rt.min., </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>          <span class="sc">-</span>Post.curation.result,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>Fill.., <span class="sc">-</span>MS.MS.assigned,<span class="sc">-</span>Reference.RT,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>Reference.m.z, <span class="sc">-</span>Formula, <span class="sc">-</span>Ontology,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>INCHIKEY, <span class="sc">-</span>SMILES, <span class="sc">-</span>Annotation.tag..VS1.<span class="fl">0.</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>RT.matched, <span class="sc">-</span>m.z.matched, <span class="sc">-</span>MS.MS.matched,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>Comment, <span class="sc">-</span>Manually.modified.for.quantification,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>Manually.modified.for.annotation, <span class="sc">-</span>Isotope.tracking.parent.ID,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>Isotope.tracking.weight.number, <span class="sc">-</span>RT.similarity,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>m.z.similarity, <span class="sc">-</span>Simple.dot.product,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>Weighted.dot.product, <span class="sc">-</span>Reverse.dot.product,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>Matched.peaks.count, <span class="sc">-</span>Matched.peaks.percentage,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>Total.score, <span class="sc">-</span>S.N.average, <span class="sc">-</span>Spectrum.reference.file.name,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>MS1.isotopic.spectrum, <span class="sc">-</span>MS.MS.spectrum, <span class="sc">-</span>X1, <span class="sc">-</span>X1<span class="fl">.1</span>)<span class="sc">|&gt;</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Adduct.type <span class="sc">==</span> <span class="st">"[M+H]+"</span>)<span class="sc">|&gt;</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Adduct.type)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>aa_row <span class="ot">&lt;-</span> filt_aligned<span class="sc">|&gt;</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">abs</span>(Average.Mz <span class="sc">==</span> <span class="fl">137.10934</span>) <span class="sc">&lt;</span> <span class="fl">1e-4</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">2</span>)<span class="sc">|&gt;</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Average.Mz, <span class="sc">-</span>Metabolite.name)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>norm_data<span class="ot">&lt;-</span>filt_aligned<span class="sc">|&gt;</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">abs</span>(Average.Mz <span class="sc">-</span> <span class="fl">137.1093</span>) <span class="sc">&gt;</span> <span class="fl">1e-4</span>)<span class="sc">|&gt;</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Average.Mz)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>norm_1<span class="ot">&lt;-</span> norm_data<span class="sc">|&gt;</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Metabolite.name)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>norm_corrected<span class="ot">&lt;-</span> <span class="fu">sweep</span>(norm_1, <span class="dv">2</span>,<span class="fu">as.numeric</span>(aa_row), <span class="st">"/"</span>)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>IDS<span class="ot">&lt;-</span>norm_data<span class="sc">|&gt;</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Metabolite.name)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>normalized_mymz<span class="ot">&lt;-</span>norm_corrected<span class="sc">|&gt;</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">ID =</span> IDS)<span class="sc">|&gt;</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Metabolite.name <span class="sc">!=</span> <span class="st">"Unknown"</span>)<span class="sc">|&gt;</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Blank_B)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>subtracted_blank <span class="ot">&lt;-</span> normalized_mymz <span class="sc">|&gt;</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Metabolite.name)<span class="sc">|&gt;</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="sc">-</span>Blank_A, <span class="sc">~</span> .x <span class="sc">-</span> Blank_A)) <span class="sc">|&gt;</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>normalized_mymz_metname<span class="ot">&lt;-</span>normalized_mymz<span class="sc">|&gt;</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Metabolite.name)</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>normalized_data<span class="ot">&lt;-</span> subtracted_blank<span class="sc">|&gt;</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(normalized_mymz_metname)<span class="sc">|&gt;</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Blank_A)</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>normalized_data[normalized_data <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(normalized_data, <span class="st">"normalized_myms_data.csv"</span>)</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>norm_myms<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"normalized_myms_data.csv"</span>)<span class="sc">|&gt;</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>X)</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a><span class="do">##read in alignment data from han et al</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a><span class="do">##these datasets are too large so I will just show the code but now run any of it</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'data.table'

The following objects are masked from 'package:lubridate':

    hour, isoweek, mday, minute, month, quarter, second, wday, week,
    yday, year

The following objects are masked from 'package:dplyr':

    between, first, last

The following object is masked from 'package:purrr':

    transpose</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># spread_df&lt;-read.csv("spread1.csv")</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># filt_spread1&lt;-spread_df|&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Alignment.ID, -Average.Rt.min., </span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#           -Post.curation.result,</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Fill.., -MS.MS.assigned,-Reference.RT,</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Reference.m.z, -Formula, -Ontology,</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#          -INCHIKEY, -SMILES, -Annotation.tag..VS1.0.,</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#          -RT.matched, -m.z.matched, -MS.MS.matched,</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Comment, -Manually.modified.for.quantification,</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Manually.modified.for.annotation, -Isotope.tracking.parent.ID,</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Isotope.tracking.weight.number, -RT.similarity,</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#          -m.z.similarity, -Simple.dot.product,</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Weighted.dot.product, -Reverse.dot.product,</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Matched.peaks.count, -Matched.peaks.percentage,</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Total.score, -S.N.average, -Spectrum.reference.file.name,</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co">#          -MS1.isotopic.spectrum, -MS.MS.spectrum, -X1, -X1.1)|&gt;</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Adduct.type == "[M+H]+")|&gt;</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Adduct.type)</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># aa_row1 &lt;- filt_spread1|&gt;</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(abs(Average.Mz - 137.1075) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   slice(2)|&gt;</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz, -Metabolite.name)</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_data1&lt;-filt_spread1|&gt;</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!abs(Average.Mz -137.1075) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz)</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_a1&lt;- norm_data1|&gt;</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Metabolite.name)</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_corrected1&lt;- sweep(norm_a1, 2,as.numeric(aa_row1), "/")</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="co"># IDS_1&lt;-norm_data1|&gt;</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(Metabolite.name)</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized_a1&lt;-norm_corrected1|&gt;</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="co">#   cbind(ID = IDS_1)|&gt;</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Metabolite.name != "Unknown")</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(normalized_a1, "normalized_a1.csv")</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized_a1&lt;- read.csv("normalized_a1.csv")|&gt;</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="co"># select(-X)|&gt;</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!str_detect(Metabolite.name, "w/o"))</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="co"># spread2_df&lt;-read.csv("spread2.csv")</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a><span class="co"># filt_spread2&lt;-spread2_df|&gt;</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Alignment.ID, -Average.Rt.min., </span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a><span class="co">#           -Post.curation.result,</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Fill.., -MS.MS.assigned,-Reference.RT,</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Reference.m.z, -Formula, -Ontology,</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a><span class="co">#          -INCHIKEY, -SMILES, -Annotation.tag..VS1.0.,</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a><span class="co">#          -RT.matched, -m.z.matched, -MS.MS.matched,</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Comment, -Manually.modified.for.quantification,</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Manually.modified.for.annotation, -Isotope.tracking.parent.ID,</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Isotope.tracking.weight.number, -RT.similarity,</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a><span class="co">#          -m.z.similarity, -Simple.dot.product,</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Weighted.dot.product, -Reverse.dot.product,</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Matched.peaks.count, -Matched.peaks.percentage,</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Total.score, -S.N.average, -Spectrum.reference.file.name,</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a><span class="co">#          -MS1.isotopic.spectrum, -MS.MS.spectrum, -X1, -X1.1)|&gt;</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Adduct.type == "[M+H]+")|&gt;</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Adduct.type)</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a><span class="co"># aa_row2 &lt;- filt_spread2|&gt;</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(abs(Average.Mz - 137.1076) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a><span class="co">#   slice(2)|&gt;</span></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz, -Metabolite.name)</span></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_data2&lt;-filt_spread2|&gt;</span></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!abs(Average.Mz -137.1076) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz)</span></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_a2&lt;- norm_data2|&gt;</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Metabolite.name)</span></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_corrected2&lt;- sweep(norm_a2, 2,as.numeric(aa_row2), "/")</span></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a><span class="co"># IDS_2&lt;-norm_data2|&gt;</span></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(Metabolite.name)</span></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized_a2&lt;-norm_corrected2|&gt;</span></span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a><span class="co">#   cbind(ID = IDS_2)|&gt;</span></span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Metabolite.name != "Unknown")</span></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(normalized_a2, "normalized_a2.csv")</span></span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a><span class="co"># spread3_df&lt;-read.csv("spread3.csv")</span></span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a><span class="co"># filt_spread3&lt;-spread3_df|&gt;</span></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Alignment.ID, -Average.Rt.min., </span></span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a><span class="co">#           -Post.curation.result,</span></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Fill.., -MS.MS.assigned,-Reference.RT,</span></span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Reference.m.z, -Formula, -Ontology,</span></span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a><span class="co">#          -INCHIKEY, -SMILES, -Annotation.tag..VS1.0.,</span></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a><span class="co">#          -RT.matched, -m.z.matched, -MS.MS.matched,</span></span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Comment, -Manually.modified.for.quantification,</span></span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Manually.modified.for.annotation, -Isotope.tracking.parent.ID,</span></span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Isotope.tracking.weight.number, -RT.similarity,</span></span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a><span class="co">#          -m.z.similarity, -Simple.dot.product,</span></span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Weighted.dot.product, -Reverse.dot.product,</span></span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Matched.peaks.count, -Matched.peaks.percentage,</span></span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Total.score, -S.N.average, -Spectrum.reference.file.name,</span></span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a><span class="co">#          -MS1.isotopic.spectrum, -MS.MS.spectrum, -X1, -X1.1)|&gt;</span></span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Adduct.type == "[M+H]+")|&gt;</span></span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Adduct.type)</span></span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a><span class="co"># aa_row3 &lt;- filt_spread3|&gt;</span></span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(abs(Average.Mz - 137.1077) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz, -Metabolite.name)</span></span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_data3&lt;-filt_spread3|&gt;</span></span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!abs(Average.Mz -137.1077) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz)</span></span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_a3&lt;- norm_data3|&gt;</span></span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Metabolite.name)</span></span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_corrected3&lt;- sweep(norm_a3, 2,as.numeric(aa_row3), "/")</span></span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a><span class="co"># IDS_3&lt;-norm_data3|&gt;</span></span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(Metabolite.name)</span></span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized_a3&lt;-norm_corrected3|&gt;</span></span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a><span class="co">#   cbind(ID = IDS_3)|&gt;</span></span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Metabolite.name != "Unknown")</span></span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(normalized_a3, "normalized_a3.csv")</span></span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a><span class="co"># spread4_df&lt;-read.csv("spread4.csv")</span></span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a><span class="co"># filt_spread4&lt;-spread4_df|&gt;</span></span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Alignment.ID, -Average.Rt.min., </span></span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a><span class="co">#           -Post.curation.result,</span></span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Fill.., -MS.MS.assigned,-Reference.RT,</span></span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Reference.m.z, -Formula, -Ontology,</span></span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a><span class="co">#          -INCHIKEY, -SMILES, -Annotation.tag..VS1.0.,</span></span>
<span id="cb5-125"><a href="#cb5-125" aria-hidden="true" tabindex="-1"></a><span class="co">#          -RT.matched, -m.z.matched, -MS.MS.matched,</span></span>
<span id="cb5-126"><a href="#cb5-126" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Comment, -Manually.modified.for.quantification,</span></span>
<span id="cb5-127"><a href="#cb5-127" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Manually.modified.for.annotation, -Isotope.tracking.parent.ID,</span></span>
<span id="cb5-128"><a href="#cb5-128" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Isotope.tracking.weight.number, -RT.similarity,</span></span>
<span id="cb5-129"><a href="#cb5-129" aria-hidden="true" tabindex="-1"></a><span class="co">#          -m.z.similarity, -Simple.dot.product,</span></span>
<span id="cb5-130"><a href="#cb5-130" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Weighted.dot.product, -Reverse.dot.product,</span></span>
<span id="cb5-131"><a href="#cb5-131" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Matched.peaks.count, -Matched.peaks.percentage,</span></span>
<span id="cb5-132"><a href="#cb5-132" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Total.score, -S.N.average, -Spectrum.reference.file.name,</span></span>
<span id="cb5-133"><a href="#cb5-133" aria-hidden="true" tabindex="-1"></a><span class="co">#          -MS1.isotopic.spectrum, -MS.MS.spectrum, -X1, -X1.1)|&gt;</span></span>
<span id="cb5-134"><a href="#cb5-134" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Adduct.type == "[M+H]+")|&gt;</span></span>
<span id="cb5-135"><a href="#cb5-135" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Adduct.type)</span></span>
<span id="cb5-136"><a href="#cb5-136" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-137"><a href="#cb5-137" aria-hidden="true" tabindex="-1"></a><span class="co"># aa_row4 &lt;- filt_spread4|&gt;</span></span>
<span id="cb5-138"><a href="#cb5-138" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(abs(Average.Mz - 137.1077) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-139"><a href="#cb5-139" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz, -Metabolite.name)</span></span>
<span id="cb5-140"><a href="#cb5-140" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-141"><a href="#cb5-141" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_data4&lt;-filt_spread4|&gt;</span></span>
<span id="cb5-142"><a href="#cb5-142" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!abs(Average.Mz -137.1077) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-143"><a href="#cb5-143" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz)</span></span>
<span id="cb5-144"><a href="#cb5-144" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_a4&lt;- norm_data4|&gt;</span></span>
<span id="cb5-145"><a href="#cb5-145" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Metabolite.name)</span></span>
<span id="cb5-146"><a href="#cb5-146" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_corrected4&lt;- sweep(norm_a4, 2,as.numeric(aa_row4), "/")</span></span>
<span id="cb5-147"><a href="#cb5-147" aria-hidden="true" tabindex="-1"></a><span class="co"># IDS_4&lt;-norm_data4|&gt;</span></span>
<span id="cb5-148"><a href="#cb5-148" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(Metabolite.name)</span></span>
<span id="cb5-149"><a href="#cb5-149" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized_a4&lt;-norm_corrected4|&gt;</span></span>
<span id="cb5-150"><a href="#cb5-150" aria-hidden="true" tabindex="-1"></a><span class="co">#   cbind(ID = IDS_4)|&gt;</span></span>
<span id="cb5-151"><a href="#cb5-151" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Metabolite.name != "Unknown")</span></span>
<span id="cb5-152"><a href="#cb5-152" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-153"><a href="#cb5-153" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(normalized_a4, "normalized_a4.csv")</span></span>
<span id="cb5-154"><a href="#cb5-154" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-155"><a href="#cb5-155" aria-hidden="true" tabindex="-1"></a><span class="co"># spread5_df&lt;-read.csv("spread5.csv")</span></span>
<span id="cb5-156"><a href="#cb5-156" aria-hidden="true" tabindex="-1"></a><span class="co"># filt_spread5&lt;-spread5_df|&gt;</span></span>
<span id="cb5-157"><a href="#cb5-157" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Alignment.ID, -Average.Rt.min., </span></span>
<span id="cb5-158"><a href="#cb5-158" aria-hidden="true" tabindex="-1"></a><span class="co">#           -Post.curation.result,</span></span>
<span id="cb5-159"><a href="#cb5-159" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Fill.., -MS.MS.assigned,-Reference.RT,</span></span>
<span id="cb5-160"><a href="#cb5-160" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Reference.m.z, -Formula, -Ontology,</span></span>
<span id="cb5-161"><a href="#cb5-161" aria-hidden="true" tabindex="-1"></a><span class="co">#          -INCHIKEY, -SMILES, -Annotation.tag..VS1.0.,</span></span>
<span id="cb5-162"><a href="#cb5-162" aria-hidden="true" tabindex="-1"></a><span class="co">#          -RT.matched, -m.z.matched, -MS.MS.matched,</span></span>
<span id="cb5-163"><a href="#cb5-163" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Comment, -Manually.modified.for.quantification,</span></span>
<span id="cb5-164"><a href="#cb5-164" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Manually.modified.for.annotation, -Isotope.tracking.parent.ID,</span></span>
<span id="cb5-165"><a href="#cb5-165" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Isotope.tracking.weight.number, -RT.similarity,</span></span>
<span id="cb5-166"><a href="#cb5-166" aria-hidden="true" tabindex="-1"></a><span class="co">#          -m.z.similarity, -Simple.dot.product,</span></span>
<span id="cb5-167"><a href="#cb5-167" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Weighted.dot.product, -Reverse.dot.product,</span></span>
<span id="cb5-168"><a href="#cb5-168" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Matched.peaks.count, -Matched.peaks.percentage,</span></span>
<span id="cb5-169"><a href="#cb5-169" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Total.score, -S.N.average, -Spectrum.reference.file.name,</span></span>
<span id="cb5-170"><a href="#cb5-170" aria-hidden="true" tabindex="-1"></a><span class="co">#          -MS1.isotopic.spectrum, -MS.MS.spectrum, -X1, -X1.1)|&gt;</span></span>
<span id="cb5-171"><a href="#cb5-171" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Adduct.type == "[M+H]+")|&gt;</span></span>
<span id="cb5-172"><a href="#cb5-172" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Adduct.type)</span></span>
<span id="cb5-173"><a href="#cb5-173" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-174"><a href="#cb5-174" aria-hidden="true" tabindex="-1"></a><span class="co"># aa_row5 &lt;- filt_spread5|&gt;</span></span>
<span id="cb5-175"><a href="#cb5-175" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(abs(Average.Mz - 137.1141) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-176"><a href="#cb5-176" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz, -Metabolite.name)</span></span>
<span id="cb5-177"><a href="#cb5-177" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-178"><a href="#cb5-178" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_data5&lt;-filt_spread5|&gt;</span></span>
<span id="cb5-179"><a href="#cb5-179" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!abs(Average.Mz -137.1141) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-180"><a href="#cb5-180" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz)</span></span>
<span id="cb5-181"><a href="#cb5-181" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_a5&lt;- norm_data5|&gt;</span></span>
<span id="cb5-182"><a href="#cb5-182" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Metabolite.name)</span></span>
<span id="cb5-183"><a href="#cb5-183" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_corrected5&lt;- sweep(norm_a5, 2,as.numeric(aa_row5), "/")</span></span>
<span id="cb5-184"><a href="#cb5-184" aria-hidden="true" tabindex="-1"></a><span class="co"># IDS_5&lt;-norm_data5|&gt;</span></span>
<span id="cb5-185"><a href="#cb5-185" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(Metabolite.name)</span></span>
<span id="cb5-186"><a href="#cb5-186" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized_a5&lt;-norm_corrected5|&gt;</span></span>
<span id="cb5-187"><a href="#cb5-187" aria-hidden="true" tabindex="-1"></a><span class="co">#   cbind(ID = IDS_5)|&gt;</span></span>
<span id="cb5-188"><a href="#cb5-188" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Metabolite.name != "Unknown")</span></span>
<span id="cb5-189"><a href="#cb5-189" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-190"><a href="#cb5-190" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(normalized_a5, "normalized_a5.csv")</span></span>
<span id="cb5-191"><a href="#cb5-191" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-192"><a href="#cb5-192" aria-hidden="true" tabindex="-1"></a><span class="co"># spread6_df&lt;-read.csv("spread 6.csv")</span></span>
<span id="cb5-193"><a href="#cb5-193" aria-hidden="true" tabindex="-1"></a><span class="co"># filt_spread6&lt;-spread6_df|&gt;</span></span>
<span id="cb5-194"><a href="#cb5-194" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Alignment.ID, -Average.Rt.min., </span></span>
<span id="cb5-195"><a href="#cb5-195" aria-hidden="true" tabindex="-1"></a><span class="co">#           -Post.curation.result,</span></span>
<span id="cb5-196"><a href="#cb5-196" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Fill.., -MS.MS.assigned,-Reference.RT,</span></span>
<span id="cb5-197"><a href="#cb5-197" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Reference.m.z, -Formula, -Ontology,</span></span>
<span id="cb5-198"><a href="#cb5-198" aria-hidden="true" tabindex="-1"></a><span class="co">#          -INCHIKEY, -SMILES, -Annotation.tag..VS1.0.,</span></span>
<span id="cb5-199"><a href="#cb5-199" aria-hidden="true" tabindex="-1"></a><span class="co">#          -RT.matched, -m.z.matched, -MS.MS.matched,</span></span>
<span id="cb5-200"><a href="#cb5-200" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Comment, -Manually.modified.for.quantification,</span></span>
<span id="cb5-201"><a href="#cb5-201" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Manually.modified.for.annotation, -Isotope.tracking.parent.ID,</span></span>
<span id="cb5-202"><a href="#cb5-202" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Isotope.tracking.weight.number, -RT.similarity,</span></span>
<span id="cb5-203"><a href="#cb5-203" aria-hidden="true" tabindex="-1"></a><span class="co">#          -m.z.similarity, -Simple.dot.product,</span></span>
<span id="cb5-204"><a href="#cb5-204" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Weighted.dot.product, -Reverse.dot.product,</span></span>
<span id="cb5-205"><a href="#cb5-205" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Matched.peaks.count, -Matched.peaks.percentage,</span></span>
<span id="cb5-206"><a href="#cb5-206" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Total.score, -S.N.average, -Spectrum.reference.file.name,</span></span>
<span id="cb5-207"><a href="#cb5-207" aria-hidden="true" tabindex="-1"></a><span class="co">#          -MS1.isotopic.spectrum, -MS.MS.spectrum, -X1, -X1.1)|&gt;</span></span>
<span id="cb5-208"><a href="#cb5-208" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Adduct.type == "[M+H]+")|&gt;</span></span>
<span id="cb5-209"><a href="#cb5-209" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Adduct.type)</span></span>
<span id="cb5-210"><a href="#cb5-210" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-211"><a href="#cb5-211" aria-hidden="true" tabindex="-1"></a><span class="co"># aa_row6 &lt;- filt_spread6|&gt;</span></span>
<span id="cb5-212"><a href="#cb5-212" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(abs(Average.Mz - 137.1074) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-213"><a href="#cb5-213" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz, -Metabolite.name)</span></span>
<span id="cb5-214"><a href="#cb5-214" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-215"><a href="#cb5-215" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_data6&lt;-filt_spread6|&gt;</span></span>
<span id="cb5-216"><a href="#cb5-216" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!abs(Average.Mz -137.1074) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-217"><a href="#cb5-217" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz)</span></span>
<span id="cb5-218"><a href="#cb5-218" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_a6&lt;- norm_data6|&gt;</span></span>
<span id="cb5-219"><a href="#cb5-219" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Metabolite.name)</span></span>
<span id="cb5-220"><a href="#cb5-220" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_corrected6&lt;- sweep(norm_a6, 2,as.numeric(aa_row6), "/")</span></span>
<span id="cb5-221"><a href="#cb5-221" aria-hidden="true" tabindex="-1"></a><span class="co"># IDS_6&lt;-norm_data6|&gt;</span></span>
<span id="cb5-222"><a href="#cb5-222" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(Metabolite.name)</span></span>
<span id="cb5-223"><a href="#cb5-223" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized_a6&lt;-norm_corrected6|&gt;</span></span>
<span id="cb5-224"><a href="#cb5-224" aria-hidden="true" tabindex="-1"></a><span class="co">#   cbind(ID = IDS_6)|&gt;</span></span>
<span id="cb5-225"><a href="#cb5-225" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Metabolite.name != "Unknown")</span></span>
<span id="cb5-226"><a href="#cb5-226" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-227"><a href="#cb5-227" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(normalized_a6, "normalized_a6.csv")</span></span>
<span id="cb5-228"><a href="#cb5-228" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-229"><a href="#cb5-229" aria-hidden="true" tabindex="-1"></a><span class="co"># spread7_df&lt;-read.csv("spread7.csv")</span></span>
<span id="cb5-230"><a href="#cb5-230" aria-hidden="true" tabindex="-1"></a><span class="co"># filt_spread7&lt;-spread7_df|&gt;</span></span>
<span id="cb5-231"><a href="#cb5-231" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Alignment.ID, -Average.Rt.min., </span></span>
<span id="cb5-232"><a href="#cb5-232" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Post.curation.result,</span></span>
<span id="cb5-233"><a href="#cb5-233" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Fill.., -MS.MS.assigned,-Reference.RT,</span></span>
<span id="cb5-234"><a href="#cb5-234" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Reference.m.z, -Formula, -Ontology,</span></span>
<span id="cb5-235"><a href="#cb5-235" aria-hidden="true" tabindex="-1"></a><span class="co">#          -INCHIKEY, -SMILES, -Annotation.tag..VS1.0.,</span></span>
<span id="cb5-236"><a href="#cb5-236" aria-hidden="true" tabindex="-1"></a><span class="co">#          -RT.matched, -m.z.matched, -MS.MS.matched,</span></span>
<span id="cb5-237"><a href="#cb5-237" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Comment, -Manually.modified.for.quantification,</span></span>
<span id="cb5-238"><a href="#cb5-238" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Manually.modified.for.annotation, -Isotope.tracking.parent.ID,</span></span>
<span id="cb5-239"><a href="#cb5-239" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Isotope.tracking.weight.number, -RT.similarity,</span></span>
<span id="cb5-240"><a href="#cb5-240" aria-hidden="true" tabindex="-1"></a><span class="co">#          -m.z.similarity, -Simple.dot.product,</span></span>
<span id="cb5-241"><a href="#cb5-241" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Weighted.dot.product, -Reverse.dot.product,</span></span>
<span id="cb5-242"><a href="#cb5-242" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Matched.peaks.count, -Matched.peaks.percentage,</span></span>
<span id="cb5-243"><a href="#cb5-243" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Total.score, -S.N.average, -Spectrum.reference.file.name,</span></span>
<span id="cb5-244"><a href="#cb5-244" aria-hidden="true" tabindex="-1"></a><span class="co">#          -MS1.isotopic.spectrum, -MS.MS.spectrum, -X1, -X1.1)|&gt;</span></span>
<span id="cb5-245"><a href="#cb5-245" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Adduct.type == "[M+H]+")|&gt;</span></span>
<span id="cb5-246"><a href="#cb5-246" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Adduct.type)</span></span>
<span id="cb5-247"><a href="#cb5-247" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-248"><a href="#cb5-248" aria-hidden="true" tabindex="-1"></a><span class="co"># aa_row7 &lt;- filt_spread7|&gt;</span></span>
<span id="cb5-249"><a href="#cb5-249" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(abs(Average.Mz - 137.1074) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-250"><a href="#cb5-250" aria-hidden="true" tabindex="-1"></a><span class="co">#   slice(1)|&gt;</span></span>
<span id="cb5-251"><a href="#cb5-251" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz, -Metabolite.name)</span></span>
<span id="cb5-252"><a href="#cb5-252" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-253"><a href="#cb5-253" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_data7&lt;-filt_spread7|&gt;</span></span>
<span id="cb5-254"><a href="#cb5-254" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!abs(Average.Mz -137.1074) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-255"><a href="#cb5-255" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz)</span></span>
<span id="cb5-256"><a href="#cb5-256" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_a7&lt;- norm_data7|&gt;</span></span>
<span id="cb5-257"><a href="#cb5-257" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Metabolite.name)</span></span>
<span id="cb5-258"><a href="#cb5-258" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_corrected7&lt;- sweep(norm_a7, 2,as.numeric(aa_row7), "/")</span></span>
<span id="cb5-259"><a href="#cb5-259" aria-hidden="true" tabindex="-1"></a><span class="co"># IDS_7&lt;-norm_data7|&gt;</span></span>
<span id="cb5-260"><a href="#cb5-260" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(Metabolite.name)</span></span>
<span id="cb5-261"><a href="#cb5-261" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized_a7&lt;-norm_corrected7|&gt;</span></span>
<span id="cb5-262"><a href="#cb5-262" aria-hidden="true" tabindex="-1"></a><span class="co">#   cbind(ID = IDS_7)|&gt;</span></span>
<span id="cb5-263"><a href="#cb5-263" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Metabolite.name != "Unknown")</span></span>
<span id="cb5-264"><a href="#cb5-264" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-265"><a href="#cb5-265" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(normalized_a7, "normalized_a7.csv")</span></span>
<span id="cb5-266"><a href="#cb5-266" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-267"><a href="#cb5-267" aria-hidden="true" tabindex="-1"></a><span class="co"># spread8_df&lt;-read.csv("spread8.csv")</span></span>
<span id="cb5-268"><a href="#cb5-268" aria-hidden="true" tabindex="-1"></a><span class="co"># filt_spread8&lt;-spread8_df|&gt;</span></span>
<span id="cb5-269"><a href="#cb5-269" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Alignment.ID, -Average.Rt.min., </span></span>
<span id="cb5-270"><a href="#cb5-270" aria-hidden="true" tabindex="-1"></a><span class="co">#           -Post.curation.result,</span></span>
<span id="cb5-271"><a href="#cb5-271" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Fill.., -MS.MS.assigned,-Reference.RT,</span></span>
<span id="cb5-272"><a href="#cb5-272" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Reference.m.z, -Formula, -Ontology,</span></span>
<span id="cb5-273"><a href="#cb5-273" aria-hidden="true" tabindex="-1"></a><span class="co">#          -INCHIKEY, -SMILES, -Annotation.tag..VS1.0.,</span></span>
<span id="cb5-274"><a href="#cb5-274" aria-hidden="true" tabindex="-1"></a><span class="co">#          -RT.matched, -m.z.matched, -MS.MS.matched,</span></span>
<span id="cb5-275"><a href="#cb5-275" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Comment, -Manually.modified.for.quantification,</span></span>
<span id="cb5-276"><a href="#cb5-276" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Manually.modified.for.annotation, -Isotope.tracking.parent.ID,</span></span>
<span id="cb5-277"><a href="#cb5-277" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Isotope.tracking.weight.number, -RT.similarity,</span></span>
<span id="cb5-278"><a href="#cb5-278" aria-hidden="true" tabindex="-1"></a><span class="co">#          -m.z.similarity, -Simple.dot.product,</span></span>
<span id="cb5-279"><a href="#cb5-279" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Weighted.dot.product, -Reverse.dot.product,</span></span>
<span id="cb5-280"><a href="#cb5-280" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Matched.peaks.count, -Matched.peaks.percentage,</span></span>
<span id="cb5-281"><a href="#cb5-281" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Total.score, -S.N.average, -Spectrum.reference.file.name,</span></span>
<span id="cb5-282"><a href="#cb5-282" aria-hidden="true" tabindex="-1"></a><span class="co">#          -MS1.isotopic.spectrum, -MS.MS.spectrum, -X1, -X1.1)|&gt;</span></span>
<span id="cb5-283"><a href="#cb5-283" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Adduct.type == "[M+H]+")|&gt;</span></span>
<span id="cb5-284"><a href="#cb5-284" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Adduct.type)</span></span>
<span id="cb5-285"><a href="#cb5-285" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-286"><a href="#cb5-286" aria-hidden="true" tabindex="-1"></a><span class="co"># aa_row8 &lt;- filt_spread8|&gt;</span></span>
<span id="cb5-287"><a href="#cb5-287" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(abs(Average.Mz - 137.1075) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-288"><a href="#cb5-288" aria-hidden="true" tabindex="-1"></a><span class="co">#   slice(1)|&gt;</span></span>
<span id="cb5-289"><a href="#cb5-289" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz, -Metabolite.name)</span></span>
<span id="cb5-290"><a href="#cb5-290" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-291"><a href="#cb5-291" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_data8&lt;-filt_spread8|&gt;</span></span>
<span id="cb5-292"><a href="#cb5-292" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!abs(Average.Mz -137.1075) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-293"><a href="#cb5-293" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz)</span></span>
<span id="cb5-294"><a href="#cb5-294" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_a8&lt;- norm_data8|&gt;</span></span>
<span id="cb5-295"><a href="#cb5-295" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Metabolite.name)</span></span>
<span id="cb5-296"><a href="#cb5-296" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_corrected8&lt;- sweep(norm_a8, 2,as.numeric(aa_row8), "/")</span></span>
<span id="cb5-297"><a href="#cb5-297" aria-hidden="true" tabindex="-1"></a><span class="co"># IDS_8&lt;-norm_data8|&gt;</span></span>
<span id="cb5-298"><a href="#cb5-298" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(Metabolite.name)</span></span>
<span id="cb5-299"><a href="#cb5-299" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized_a8&lt;-norm_corrected8|&gt;</span></span>
<span id="cb5-300"><a href="#cb5-300" aria-hidden="true" tabindex="-1"></a><span class="co">#   cbind(ID = IDS_8)|&gt;</span></span>
<span id="cb5-301"><a href="#cb5-301" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Metabolite.name != "Unknown")</span></span>
<span id="cb5-302"><a href="#cb5-302" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-303"><a href="#cb5-303" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(normalized_a8, "normalized_a8.csv")</span></span>
<span id="cb5-304"><a href="#cb5-304" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-305"><a href="#cb5-305" aria-hidden="true" tabindex="-1"></a><span class="co"># spread9_df&lt;-read.csv("spread9.csv")</span></span>
<span id="cb5-306"><a href="#cb5-306" aria-hidden="true" tabindex="-1"></a><span class="co"># filt_spread9&lt;-spread9_df|&gt;</span></span>
<span id="cb5-307"><a href="#cb5-307" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Alignment.ID, -Average.Rt.min., </span></span>
<span id="cb5-308"><a href="#cb5-308" aria-hidden="true" tabindex="-1"></a><span class="co">#           -Post.curation.result,</span></span>
<span id="cb5-309"><a href="#cb5-309" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Fill.., -MS.MS.assigned,-Reference.RT,</span></span>
<span id="cb5-310"><a href="#cb5-310" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Reference.m.z, -Formula, -Ontology,</span></span>
<span id="cb5-311"><a href="#cb5-311" aria-hidden="true" tabindex="-1"></a><span class="co">#          -INCHIKEY, -SMILES, -Annotation.tag..VS1.0.,</span></span>
<span id="cb5-312"><a href="#cb5-312" aria-hidden="true" tabindex="-1"></a><span class="co">#          -RT.matched, -m.z.matched, -MS.MS.matched,</span></span>
<span id="cb5-313"><a href="#cb5-313" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Comment, -Manually.modified.for.quantification,</span></span>
<span id="cb5-314"><a href="#cb5-314" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Manually.modified.for.annotation, -Isotope.tracking.parent.ID,</span></span>
<span id="cb5-315"><a href="#cb5-315" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Isotope.tracking.weight.number, -RT.similarity,</span></span>
<span id="cb5-316"><a href="#cb5-316" aria-hidden="true" tabindex="-1"></a><span class="co">#          -m.z.similarity, -Simple.dot.product,</span></span>
<span id="cb5-317"><a href="#cb5-317" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Weighted.dot.product, -Reverse.dot.product,</span></span>
<span id="cb5-318"><a href="#cb5-318" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Matched.peaks.count, -Matched.peaks.percentage,</span></span>
<span id="cb5-319"><a href="#cb5-319" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Total.score, -S.N.average, -Spectrum.reference.file.name,</span></span>
<span id="cb5-320"><a href="#cb5-320" aria-hidden="true" tabindex="-1"></a><span class="co">#          -MS1.isotopic.spectrum, -MS.MS.spectrum, -X1, -X1.1)|&gt;</span></span>
<span id="cb5-321"><a href="#cb5-321" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Adduct.type == "[M+H]+")|&gt;</span></span>
<span id="cb5-322"><a href="#cb5-322" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Adduct.type)</span></span>
<span id="cb5-323"><a href="#cb5-323" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-324"><a href="#cb5-324" aria-hidden="true" tabindex="-1"></a><span class="co"># aa_row9 &lt;- filt_spread9|&gt;</span></span>
<span id="cb5-325"><a href="#cb5-325" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(abs(Average.Mz - 137.1076) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-326"><a href="#cb5-326" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz, -Metabolite.name)</span></span>
<span id="cb5-327"><a href="#cb5-327" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-328"><a href="#cb5-328" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_data9&lt;-filt_spread9|&gt;</span></span>
<span id="cb5-329"><a href="#cb5-329" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!abs(Average.Mz -137.1076) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-330"><a href="#cb5-330" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz)</span></span>
<span id="cb5-331"><a href="#cb5-331" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_a9&lt;- norm_data9|&gt;</span></span>
<span id="cb5-332"><a href="#cb5-332" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Metabolite.name)</span></span>
<span id="cb5-333"><a href="#cb5-333" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_corrected9&lt;- sweep(norm_a9, 2,as.numeric(aa_row9), "/")</span></span>
<span id="cb5-334"><a href="#cb5-334" aria-hidden="true" tabindex="-1"></a><span class="co"># IDS_9&lt;-norm_data9|&gt;</span></span>
<span id="cb5-335"><a href="#cb5-335" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(Metabolite.name)</span></span>
<span id="cb5-336"><a href="#cb5-336" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized_a9&lt;-norm_corrected9|&gt;</span></span>
<span id="cb5-337"><a href="#cb5-337" aria-hidden="true" tabindex="-1"></a><span class="co">#   cbind(ID = IDS_9)|&gt;</span></span>
<span id="cb5-338"><a href="#cb5-338" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Metabolite.name != "Unknown")</span></span>
<span id="cb5-339"><a href="#cb5-339" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-340"><a href="#cb5-340" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(normalized_a9, "normalized_a9.csv")</span></span>
<span id="cb5-341"><a href="#cb5-341" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-342"><a href="#cb5-342" aria-hidden="true" tabindex="-1"></a><span class="co"># spread10_df&lt;-read.csv("spread10.csv")</span></span>
<span id="cb5-343"><a href="#cb5-343" aria-hidden="true" tabindex="-1"></a><span class="co"># filt_spread10&lt;-spread10_df|&gt;</span></span>
<span id="cb5-344"><a href="#cb5-344" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Alignment.ID, -Average.Rt.min., </span></span>
<span id="cb5-345"><a href="#cb5-345" aria-hidden="true" tabindex="-1"></a><span class="co">#           -Post.curation.result,</span></span>
<span id="cb5-346"><a href="#cb5-346" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Fill.., -MS.MS.assigned,-Reference.RT,</span></span>
<span id="cb5-347"><a href="#cb5-347" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Reference.m.z, -Formula, -Ontology,</span></span>
<span id="cb5-348"><a href="#cb5-348" aria-hidden="true" tabindex="-1"></a><span class="co">#          -INCHIKEY, -SMILES, -Annotation.tag..VS1.0.,</span></span>
<span id="cb5-349"><a href="#cb5-349" aria-hidden="true" tabindex="-1"></a><span class="co">#          -RT.matched, -m.z.matched, -MS.MS.matched,</span></span>
<span id="cb5-350"><a href="#cb5-350" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Comment, -Manually.modified.for.quantification,</span></span>
<span id="cb5-351"><a href="#cb5-351" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Manually.modified.for.annotation, -Isotope.tracking.parent.ID,</span></span>
<span id="cb5-352"><a href="#cb5-352" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Isotope.tracking.weight.number, -RT.similarity,</span></span>
<span id="cb5-353"><a href="#cb5-353" aria-hidden="true" tabindex="-1"></a><span class="co">#          -m.z.similarity, -Simple.dot.product,</span></span>
<span id="cb5-354"><a href="#cb5-354" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Weighted.dot.product, -Reverse.dot.product,</span></span>
<span id="cb5-355"><a href="#cb5-355" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Matched.peaks.count, -Matched.peaks.percentage,</span></span>
<span id="cb5-356"><a href="#cb5-356" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Total.score, -S.N.average, -Spectrum.reference.file.name,</span></span>
<span id="cb5-357"><a href="#cb5-357" aria-hidden="true" tabindex="-1"></a><span class="co">#          -MS1.isotopic.spectrum, -MS.MS.spectrum, -X1, -X1.1)|&gt;</span></span>
<span id="cb5-358"><a href="#cb5-358" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Adduct.type == "[M+H]+")|&gt;</span></span>
<span id="cb5-359"><a href="#cb5-359" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Adduct.type)</span></span>
<span id="cb5-360"><a href="#cb5-360" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-361"><a href="#cb5-361" aria-hidden="true" tabindex="-1"></a><span class="co"># aa_row10 &lt;- filt_spread10|&gt;</span></span>
<span id="cb5-362"><a href="#cb5-362" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(abs(Average.Mz - 137.1078) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-363"><a href="#cb5-363" aria-hidden="true" tabindex="-1"></a><span class="co">#   slice(2)|&gt;</span></span>
<span id="cb5-364"><a href="#cb5-364" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz, -Metabolite.name)</span></span>
<span id="cb5-365"><a href="#cb5-365" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-366"><a href="#cb5-366" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_data10&lt;-filt_spread10|&gt;</span></span>
<span id="cb5-367"><a href="#cb5-367" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!abs(Average.Mz -137.1078) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-368"><a href="#cb5-368" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz)</span></span>
<span id="cb5-369"><a href="#cb5-369" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_a10&lt;- norm_data10|&gt;</span></span>
<span id="cb5-370"><a href="#cb5-370" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Metabolite.name)</span></span>
<span id="cb5-371"><a href="#cb5-371" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_corrected10&lt;- sweep(norm_a10, 2,as.numeric(aa_row10), "/")</span></span>
<span id="cb5-372"><a href="#cb5-372" aria-hidden="true" tabindex="-1"></a><span class="co"># IDS_10&lt;-norm_data10|&gt;</span></span>
<span id="cb5-373"><a href="#cb5-373" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(Metabolite.name)</span></span>
<span id="cb5-374"><a href="#cb5-374" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized_a10&lt;-norm_corrected10|&gt;</span></span>
<span id="cb5-375"><a href="#cb5-375" aria-hidden="true" tabindex="-1"></a><span class="co">#   cbind(ID = IDS_10)|&gt;</span></span>
<span id="cb5-376"><a href="#cb5-376" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Metabolite.name != "Unknown")</span></span>
<span id="cb5-377"><a href="#cb5-377" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-378"><a href="#cb5-378" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(normalized_a10, "normalized_a10.csv")</span></span>
<span id="cb5-379"><a href="#cb5-379" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-380"><a href="#cb5-380" aria-hidden="true" tabindex="-1"></a><span class="co"># spread11_df&lt;-read.csv("spread11.csv")</span></span>
<span id="cb5-381"><a href="#cb5-381" aria-hidden="true" tabindex="-1"></a><span class="co"># filt_spread11&lt;-spread11_df|&gt;</span></span>
<span id="cb5-382"><a href="#cb5-382" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Alignment.ID, -Average.Rt.min., </span></span>
<span id="cb5-383"><a href="#cb5-383" aria-hidden="true" tabindex="-1"></a><span class="co">#           -Post.curation.result,</span></span>
<span id="cb5-384"><a href="#cb5-384" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Fill.., -MS.MS.assigned,-Reference.RT,</span></span>
<span id="cb5-385"><a href="#cb5-385" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Reference.m.z, -Formula, -Ontology,</span></span>
<span id="cb5-386"><a href="#cb5-386" aria-hidden="true" tabindex="-1"></a><span class="co">#          -INCHIKEY, -SMILES, -Annotation.tag..VS1.0.,</span></span>
<span id="cb5-387"><a href="#cb5-387" aria-hidden="true" tabindex="-1"></a><span class="co">#          -RT.matched, -m.z.matched, -MS.MS.matched,</span></span>
<span id="cb5-388"><a href="#cb5-388" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Comment, -Manually.modified.for.quantification,</span></span>
<span id="cb5-389"><a href="#cb5-389" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Manually.modified.for.annotation, -Isotope.tracking.parent.ID,</span></span>
<span id="cb5-390"><a href="#cb5-390" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Isotope.tracking.weight.number, -RT.similarity,</span></span>
<span id="cb5-391"><a href="#cb5-391" aria-hidden="true" tabindex="-1"></a><span class="co">#          -m.z.similarity, -Simple.dot.product,</span></span>
<span id="cb5-392"><a href="#cb5-392" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Weighted.dot.product, -Reverse.dot.product,</span></span>
<span id="cb5-393"><a href="#cb5-393" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Matched.peaks.count, -Matched.peaks.percentage,</span></span>
<span id="cb5-394"><a href="#cb5-394" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Total.score, -S.N.average, -Spectrum.reference.file.name,</span></span>
<span id="cb5-395"><a href="#cb5-395" aria-hidden="true" tabindex="-1"></a><span class="co">#          -MS1.isotopic.spectrum, -MS.MS.spectrum, -X1, -X1.1)|&gt;</span></span>
<span id="cb5-396"><a href="#cb5-396" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Adduct.type == "[M+H]+")|&gt;</span></span>
<span id="cb5-397"><a href="#cb5-397" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Adduct.type)</span></span>
<span id="cb5-398"><a href="#cb5-398" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-399"><a href="#cb5-399" aria-hidden="true" tabindex="-1"></a><span class="co"># aa_row11 &lt;- filt_spread11|&gt;</span></span>
<span id="cb5-400"><a href="#cb5-400" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(abs(Average.Mz - 137.1079) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-401"><a href="#cb5-401" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz, -Metabolite.name)</span></span>
<span id="cb5-402"><a href="#cb5-402" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-403"><a href="#cb5-403" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_data11&lt;-filt_spread11|&gt;</span></span>
<span id="cb5-404"><a href="#cb5-404" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!abs(Average.Mz -137.1079) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-405"><a href="#cb5-405" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz)</span></span>
<span id="cb5-406"><a href="#cb5-406" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_a11&lt;- norm_data11|&gt;</span></span>
<span id="cb5-407"><a href="#cb5-407" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Metabolite.name)</span></span>
<span id="cb5-408"><a href="#cb5-408" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_corrected11&lt;- sweep(norm_a11, 2,as.numeric(aa_row11), "/")</span></span>
<span id="cb5-409"><a href="#cb5-409" aria-hidden="true" tabindex="-1"></a><span class="co"># IDS_11&lt;-norm_data11|&gt;</span></span>
<span id="cb5-410"><a href="#cb5-410" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(Metabolite.name)</span></span>
<span id="cb5-411"><a href="#cb5-411" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized_a11&lt;-norm_corrected11|&gt;</span></span>
<span id="cb5-412"><a href="#cb5-412" aria-hidden="true" tabindex="-1"></a><span class="co">#   cbind(ID = IDS_11)|&gt;</span></span>
<span id="cb5-413"><a href="#cb5-413" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Metabolite.name != "Unknown")</span></span>
<span id="cb5-414"><a href="#cb5-414" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-415"><a href="#cb5-415" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(normalized_a11, "normalized_a11.csv")</span></span>
<span id="cb5-416"><a href="#cb5-416" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-417"><a href="#cb5-417" aria-hidden="true" tabindex="-1"></a><span class="co"># spread12_df&lt;-read.csv("spread12.csv")</span></span>
<span id="cb5-418"><a href="#cb5-418" aria-hidden="true" tabindex="-1"></a><span class="co"># filt_spread12&lt;-spread12_df|&gt;</span></span>
<span id="cb5-419"><a href="#cb5-419" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Alignment.ID, -Average.Rt.min., </span></span>
<span id="cb5-420"><a href="#cb5-420" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Post.curation.result,</span></span>
<span id="cb5-421"><a href="#cb5-421" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Fill.., -MS.MS.assigned,-Reference.RT,</span></span>
<span id="cb5-422"><a href="#cb5-422" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Reference.m.z, -Formula, -Ontology,</span></span>
<span id="cb5-423"><a href="#cb5-423" aria-hidden="true" tabindex="-1"></a><span class="co">#          -INCHIKEY, -SMILES, -Annotation.tag..VS1.0.,</span></span>
<span id="cb5-424"><a href="#cb5-424" aria-hidden="true" tabindex="-1"></a><span class="co">#          -RT.matched, -m.z.matched, -MS.MS.matched,</span></span>
<span id="cb5-425"><a href="#cb5-425" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Comment, -Manually.modified.for.quantification,</span></span>
<span id="cb5-426"><a href="#cb5-426" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Manually.modified.for.annotation, -Isotope.tracking.parent.ID,</span></span>
<span id="cb5-427"><a href="#cb5-427" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Isotope.tracking.weight.number, -RT.similarity,</span></span>
<span id="cb5-428"><a href="#cb5-428" aria-hidden="true" tabindex="-1"></a><span class="co">#          -m.z.similarity, -Simple.dot.product,</span></span>
<span id="cb5-429"><a href="#cb5-429" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Weighted.dot.product, -Reverse.dot.product,</span></span>
<span id="cb5-430"><a href="#cb5-430" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Matched.peaks.count, -Matched.peaks.percentage,</span></span>
<span id="cb5-431"><a href="#cb5-431" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Total.score, -S.N.average, -Spectrum.reference.file.name,</span></span>
<span id="cb5-432"><a href="#cb5-432" aria-hidden="true" tabindex="-1"></a><span class="co">#          -MS1.isotopic.spectrum, -MS.MS.spectrum, -X1, -X1.1)|&gt;</span></span>
<span id="cb5-433"><a href="#cb5-433" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Adduct.type == "[M+H]+")|&gt;</span></span>
<span id="cb5-434"><a href="#cb5-434" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Adduct.type)</span></span>
<span id="cb5-435"><a href="#cb5-435" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-436"><a href="#cb5-436" aria-hidden="true" tabindex="-1"></a><span class="co"># aa_row12 &lt;- filt_spread12|&gt;</span></span>
<span id="cb5-437"><a href="#cb5-437" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(abs(Average.Mz - 137.1076) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-438"><a href="#cb5-438" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz, -Metabolite.name)</span></span>
<span id="cb5-439"><a href="#cb5-439" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-440"><a href="#cb5-440" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_data12&lt;-filt_spread12|&gt;</span></span>
<span id="cb5-441"><a href="#cb5-441" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!abs(Average.Mz -137.1076) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-442"><a href="#cb5-442" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz)</span></span>
<span id="cb5-443"><a href="#cb5-443" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_a12&lt;- norm_data12|&gt;</span></span>
<span id="cb5-444"><a href="#cb5-444" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Metabolite.name)</span></span>
<span id="cb5-445"><a href="#cb5-445" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_corrected12&lt;- sweep(norm_a12, 2,as.numeric(aa_row12), "/")</span></span>
<span id="cb5-446"><a href="#cb5-446" aria-hidden="true" tabindex="-1"></a><span class="co"># IDS_12&lt;-norm_data12|&gt;</span></span>
<span id="cb5-447"><a href="#cb5-447" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(Metabolite.name)</span></span>
<span id="cb5-448"><a href="#cb5-448" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized_a12&lt;-norm_corrected12|&gt;</span></span>
<span id="cb5-449"><a href="#cb5-449" aria-hidden="true" tabindex="-1"></a><span class="co">#   cbind(ID = IDS_12)|&gt;</span></span>
<span id="cb5-450"><a href="#cb5-450" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Metabolite.name != "Unknown")</span></span>
<span id="cb5-451"><a href="#cb5-451" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-452"><a href="#cb5-452" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(normalized_a12, "normalized_a12.csv")</span></span>
<span id="cb5-453"><a href="#cb5-453" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-454"><a href="#cb5-454" aria-hidden="true" tabindex="-1"></a><span class="co"># spread13_df&lt;-read.csv("spread13.csv")</span></span>
<span id="cb5-455"><a href="#cb5-455" aria-hidden="true" tabindex="-1"></a><span class="co"># filt_spread13&lt;-spread13_df|&gt;</span></span>
<span id="cb5-456"><a href="#cb5-456" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Alignment.ID, -Average.Rt.min., </span></span>
<span id="cb5-457"><a href="#cb5-457" aria-hidden="true" tabindex="-1"></a><span class="co">#           -Post.curation.result,</span></span>
<span id="cb5-458"><a href="#cb5-458" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Fill.., -MS.MS.assigned,-Reference.RT,</span></span>
<span id="cb5-459"><a href="#cb5-459" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Reference.m.z, -Formula, -Ontology,</span></span>
<span id="cb5-460"><a href="#cb5-460" aria-hidden="true" tabindex="-1"></a><span class="co">#          -INCHIKEY, -SMILES, -Annotation.tag..VS1.0.,</span></span>
<span id="cb5-461"><a href="#cb5-461" aria-hidden="true" tabindex="-1"></a><span class="co">#          -RT.matched, -m.z.matched, -MS.MS.matched,</span></span>
<span id="cb5-462"><a href="#cb5-462" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Comment, -Manually.modified.for.quantification,</span></span>
<span id="cb5-463"><a href="#cb5-463" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Manually.modified.for.annotation, -Isotope.tracking.parent.ID,</span></span>
<span id="cb5-464"><a href="#cb5-464" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Isotope.tracking.weight.number, -RT.similarity,</span></span>
<span id="cb5-465"><a href="#cb5-465" aria-hidden="true" tabindex="-1"></a><span class="co">#          -m.z.similarity, -Simple.dot.product,</span></span>
<span id="cb5-466"><a href="#cb5-466" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Weighted.dot.product, -Reverse.dot.product,</span></span>
<span id="cb5-467"><a href="#cb5-467" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Matched.peaks.count, -Matched.peaks.percentage,</span></span>
<span id="cb5-468"><a href="#cb5-468" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Total.score, -S.N.average, -Spectrum.reference.file.name,</span></span>
<span id="cb5-469"><a href="#cb5-469" aria-hidden="true" tabindex="-1"></a><span class="co">#          -MS1.isotopic.spectrum, -MS.MS.spectrum, -X1, -X1.1)|&gt;</span></span>
<span id="cb5-470"><a href="#cb5-470" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Adduct.type == "[M+H]+")|&gt;</span></span>
<span id="cb5-471"><a href="#cb5-471" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Adduct.type)</span></span>
<span id="cb5-472"><a href="#cb5-472" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-473"><a href="#cb5-473" aria-hidden="true" tabindex="-1"></a><span class="co"># aa_row13 &lt;- filt_spread13|&gt;</span></span>
<span id="cb5-474"><a href="#cb5-474" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(abs(Average.Mz - 137.1096) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-475"><a href="#cb5-475" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz, -Metabolite.name)</span></span>
<span id="cb5-476"><a href="#cb5-476" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-477"><a href="#cb5-477" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_data13&lt;-filt_spread13|&gt;</span></span>
<span id="cb5-478"><a href="#cb5-478" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!abs(Average.Mz -137.1096) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-479"><a href="#cb5-479" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz)</span></span>
<span id="cb5-480"><a href="#cb5-480" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_a13&lt;- norm_data13|&gt;</span></span>
<span id="cb5-481"><a href="#cb5-481" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Metabolite.name)</span></span>
<span id="cb5-482"><a href="#cb5-482" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_corrected13&lt;- sweep(norm_a13, 2,as.numeric(aa_row13), "/")</span></span>
<span id="cb5-483"><a href="#cb5-483" aria-hidden="true" tabindex="-1"></a><span class="co"># IDS_13&lt;-norm_data13|&gt;</span></span>
<span id="cb5-484"><a href="#cb5-484" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(Metabolite.name)</span></span>
<span id="cb5-485"><a href="#cb5-485" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized_a13&lt;-norm_corrected13|&gt;</span></span>
<span id="cb5-486"><a href="#cb5-486" aria-hidden="true" tabindex="-1"></a><span class="co">#   cbind(ID = IDS_13)|&gt;</span></span>
<span id="cb5-487"><a href="#cb5-487" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Metabolite.name != "Unknown")</span></span>
<span id="cb5-488"><a href="#cb5-488" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-489"><a href="#cb5-489" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(normalized_a13, "normalized_a13.csv")</span></span>
<span id="cb5-490"><a href="#cb5-490" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-491"><a href="#cb5-491" aria-hidden="true" tabindex="-1"></a><span class="co"># spread14_df&lt;-read.csv("spread14.csv")</span></span>
<span id="cb5-492"><a href="#cb5-492" aria-hidden="true" tabindex="-1"></a><span class="co"># filt_spread14&lt;-spread14_df|&gt;</span></span>
<span id="cb5-493"><a href="#cb5-493" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Alignment.ID, -Average.Rt.min., </span></span>
<span id="cb5-494"><a href="#cb5-494" aria-hidden="true" tabindex="-1"></a><span class="co">#           -Post.curation.result,</span></span>
<span id="cb5-495"><a href="#cb5-495" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Fill.., -MS.MS.assigned,-Reference.RT,</span></span>
<span id="cb5-496"><a href="#cb5-496" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Reference.m.z, -Formula, -Ontology,</span></span>
<span id="cb5-497"><a href="#cb5-497" aria-hidden="true" tabindex="-1"></a><span class="co">#          -INCHIKEY, -SMILES, -Annotation.tag..VS1.0.,</span></span>
<span id="cb5-498"><a href="#cb5-498" aria-hidden="true" tabindex="-1"></a><span class="co">#          -RT.matched, -m.z.matched, -MS.MS.matched,</span></span>
<span id="cb5-499"><a href="#cb5-499" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Comment, -Manually.modified.for.quantification,</span></span>
<span id="cb5-500"><a href="#cb5-500" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Manually.modified.for.annotation, -Isotope.tracking.parent.ID,</span></span>
<span id="cb5-501"><a href="#cb5-501" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Isotope.tracking.weight.number, -RT.similarity,</span></span>
<span id="cb5-502"><a href="#cb5-502" aria-hidden="true" tabindex="-1"></a><span class="co">#          -m.z.similarity, -Simple.dot.product,</span></span>
<span id="cb5-503"><a href="#cb5-503" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Weighted.dot.product, -Reverse.dot.product,</span></span>
<span id="cb5-504"><a href="#cb5-504" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Matched.peaks.count, -Matched.peaks.percentage,</span></span>
<span id="cb5-505"><a href="#cb5-505" aria-hidden="true" tabindex="-1"></a><span class="co">#          -Total.score, -S.N.average, -Spectrum.reference.file.name,</span></span>
<span id="cb5-506"><a href="#cb5-506" aria-hidden="true" tabindex="-1"></a><span class="co">#          -MS1.isotopic.spectrum, -MS.MS.spectrum, -X1, -X1.1)|&gt;</span></span>
<span id="cb5-507"><a href="#cb5-507" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Adduct.type == "[M+H]+")|&gt;</span></span>
<span id="cb5-508"><a href="#cb5-508" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Adduct.type)</span></span>
<span id="cb5-509"><a href="#cb5-509" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-510"><a href="#cb5-510" aria-hidden="true" tabindex="-1"></a><span class="co"># aa_row14 &lt;- filt_spread14|&gt;</span></span>
<span id="cb5-511"><a href="#cb5-511" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(abs(Average.Mz - 137.1076) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-512"><a href="#cb5-512" aria-hidden="true" tabindex="-1"></a><span class="co">#   slice(1)|&gt;</span></span>
<span id="cb5-513"><a href="#cb5-513" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz, -Metabolite.name)</span></span>
<span id="cb5-514"><a href="#cb5-514" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-515"><a href="#cb5-515" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_data14&lt;-filt_spread14|&gt;</span></span>
<span id="cb5-516"><a href="#cb5-516" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!abs(Average.Mz -137.1076) &lt; 1e-4)|&gt;</span></span>
<span id="cb5-517"><a href="#cb5-517" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Average.Mz)</span></span>
<span id="cb5-518"><a href="#cb5-518" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_a14&lt;- norm_data14|&gt;</span></span>
<span id="cb5-519"><a href="#cb5-519" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-Metabolite.name)</span></span>
<span id="cb5-520"><a href="#cb5-520" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_corrected14&lt;- sweep(norm_a14, 2,as.numeric(aa_row14), "/")</span></span>
<span id="cb5-521"><a href="#cb5-521" aria-hidden="true" tabindex="-1"></a><span class="co"># IDS_14&lt;-norm_data14|&gt;</span></span>
<span id="cb5-522"><a href="#cb5-522" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(Metabolite.name)</span></span>
<span id="cb5-523"><a href="#cb5-523" aria-hidden="true" tabindex="-1"></a><span class="co"># normalized_a14&lt;-norm_corrected14|&gt;</span></span>
<span id="cb5-524"><a href="#cb5-524" aria-hidden="true" tabindex="-1"></a><span class="co">#   cbind(ID = IDS_14)|&gt;</span></span>
<span id="cb5-525"><a href="#cb5-525" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(Metabolite.name != "Unknown")</span></span>
<span id="cb5-526"><a href="#cb5-526" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-527"><a href="#cb5-527" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(normalized_a14, "normalized_a14.csv")</span></span>
<span id="cb5-528"><a href="#cb5-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-529"><a href="#cb5-529" aria-hidden="true" tabindex="-1"></a><span class="co">#more setting up data, now filtering after cleared environment</span></span>
<span id="cb5-530"><a href="#cb5-530" aria-hidden="true" tabindex="-1"></a>wide_normams <span class="ot">&lt;-</span> normalized_data <span class="sc">|&gt;</span></span>
<span id="cb5-531"><a href="#cb5-531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb5-532"><a href="#cb5-532" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols      =</span> <span class="sc">-</span>Metabolite.name,</span>
<span id="cb5-533"><a href="#cb5-533" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to  =</span> <span class="st">"Sample"</span>,</span>
<span id="cb5-534"><a href="#cb5-534" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Area"</span></span>
<span id="cb5-535"><a href="#cb5-535" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb5-536"><a href="#cb5-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sample, Metabolite.name)<span class="sc">|&gt;</span></span>
<span id="cb5-537"><a href="#cb5-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Area =</span> <span class="fu">mean</span>(Area),   </span>
<span id="cb5-538"><a href="#cb5-538" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-539"><a href="#cb5-539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb5-540"><a href="#cb5-540" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from  =</span> Metabolite.name,</span>
<span id="cb5-541"><a href="#cb5-541" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Area</span>
<span id="cb5-542"><a href="#cb5-542" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-543"><a href="#cb5-543" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(wide_normams, <span class="st">"wide_norm_myms.csv"</span>)</span>
<span id="cb5-544"><a href="#cb5-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-545"><a href="#cb5-545" aria-hidden="true" tabindex="-1"></a><span class="co">#again, I won't run this code but it is the same workflow</span></span>
<span id="cb5-546"><a href="#cb5-546" aria-hidden="true" tabindex="-1"></a><span class="co"># normalizeda1&lt;-read.csv("normalized_a1.csv")|&gt;</span></span>
<span id="cb5-547"><a href="#cb5-547" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-X)</span></span>
<span id="cb5-548"><a href="#cb5-548" aria-hidden="true" tabindex="-1"></a><span class="co"># wide_norma1 &lt;- normalizeda1 |&gt;</span></span>
<span id="cb5-549"><a href="#cb5-549" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(</span></span>
<span id="cb5-550"><a href="#cb5-550" aria-hidden="true" tabindex="-1"></a><span class="co">#     cols      = -Metabolite.name,</span></span>
<span id="cb5-551"><a href="#cb5-551" aria-hidden="true" tabindex="-1"></a><span class="co">#     names_to  = "Sample",</span></span>
<span id="cb5-552"><a href="#cb5-552" aria-hidden="true" tabindex="-1"></a><span class="co">#     values_to = "Area"</span></span>
<span id="cb5-553"><a href="#cb5-553" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) |&gt;</span></span>
<span id="cb5-554"><a href="#cb5-554" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(Sample, Metabolite.name)|&gt;</span></span>
<span id="cb5-555"><a href="#cb5-555" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarize(Area = mean(Area),   </span></span>
<span id="cb5-556"><a href="#cb5-556" aria-hidden="true" tabindex="-1"></a><span class="co">#             .groups = "drop") |&gt;</span></span>
<span id="cb5-557"><a href="#cb5-557" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_wider(</span></span>
<span id="cb5-558"><a href="#cb5-558" aria-hidden="true" tabindex="-1"></a><span class="co">#     names_from  = Metabolite.name,</span></span>
<span id="cb5-559"><a href="#cb5-559" aria-hidden="true" tabindex="-1"></a><span class="co">#     values_from = Area</span></span>
<span id="cb5-560"><a href="#cb5-560" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb5-561"><a href="#cb5-561" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(wide_norma1, "wide_norma1.csv")</span></span>
<span id="cb5-562"><a href="#cb5-562" aria-hidden="true" tabindex="-1"></a><span class="co"># normalizeda2&lt;-read.csv("normalized_a2.csv")|&gt;</span></span>
<span id="cb5-563"><a href="#cb5-563" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-X)</span></span>
<span id="cb5-564"><a href="#cb5-564" aria-hidden="true" tabindex="-1"></a><span class="co"># wide_norma2 &lt;- normalizeda2 |&gt;</span></span>
<span id="cb5-565"><a href="#cb5-565" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(cols = -Metabolite.name,</span></span>
<span id="cb5-566"><a href="#cb5-566" aria-hidden="true" tabindex="-1"></a><span class="co">#     names_to = "Sample",</span></span>
<span id="cb5-567"><a href="#cb5-567" aria-hidden="true" tabindex="-1"></a><span class="co">#     values_to = "Area"</span></span>
<span id="cb5-568"><a href="#cb5-568" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) |&gt;</span></span>
<span id="cb5-569"><a href="#cb5-569" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(Sample, Metabolite.name)|&gt;</span></span>
<span id="cb5-570"><a href="#cb5-570" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarize(Area = mean(Area),   </span></span>
<span id="cb5-571"><a href="#cb5-571" aria-hidden="true" tabindex="-1"></a><span class="co">#             .groups = "drop") |&gt;</span></span>
<span id="cb5-572"><a href="#cb5-572" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_wider(</span></span>
<span id="cb5-573"><a href="#cb5-573" aria-hidden="true" tabindex="-1"></a><span class="co">#     names_from  = Metabolite.name,</span></span>
<span id="cb5-574"><a href="#cb5-574" aria-hidden="true" tabindex="-1"></a><span class="co">#     values_from = Area</span></span>
<span id="cb5-575"><a href="#cb5-575" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb5-576"><a href="#cb5-576" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(wide_norma2, "wide_norma2.csv")</span></span>
<span id="cb5-577"><a href="#cb5-577" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-578"><a href="#cb5-578" aria-hidden="true" tabindex="-1"></a><span class="co"># normalizeda3&lt;-read.csv("normalized_a3.csv")|&gt;</span></span>
<span id="cb5-579"><a href="#cb5-579" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-X)</span></span>
<span id="cb5-580"><a href="#cb5-580" aria-hidden="true" tabindex="-1"></a><span class="co"># wide_norma3 &lt;- normalizeda3 |&gt;</span></span>
<span id="cb5-581"><a href="#cb5-581" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(cols = -Metabolite.name,</span></span>
<span id="cb5-582"><a href="#cb5-582" aria-hidden="true" tabindex="-1"></a><span class="co">#                names_to = "Sample",</span></span>
<span id="cb5-583"><a href="#cb5-583" aria-hidden="true" tabindex="-1"></a><span class="co">#                values_to = "Area"</span></span>
<span id="cb5-584"><a href="#cb5-584" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) |&gt;</span></span>
<span id="cb5-585"><a href="#cb5-585" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(Sample, Metabolite.name)|&gt;</span></span>
<span id="cb5-586"><a href="#cb5-586" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarize(Area = mean(Area),   </span></span>
<span id="cb5-587"><a href="#cb5-587" aria-hidden="true" tabindex="-1"></a><span class="co">#             .groups = "drop") |&gt;</span></span>
<span id="cb5-588"><a href="#cb5-588" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_wider(</span></span>
<span id="cb5-589"><a href="#cb5-589" aria-hidden="true" tabindex="-1"></a><span class="co">#     names_from  = Metabolite.name,</span></span>
<span id="cb5-590"><a href="#cb5-590" aria-hidden="true" tabindex="-1"></a><span class="co">#     values_from = Area</span></span>
<span id="cb5-591"><a href="#cb5-591" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb5-592"><a href="#cb5-592" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(wide_norma3, "wide_norma3.csv")</span></span>
<span id="cb5-593"><a href="#cb5-593" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-594"><a href="#cb5-594" aria-hidden="true" tabindex="-1"></a><span class="co"># normalizeda4&lt;-read.csv("normalized_a4.csv")|&gt;</span></span>
<span id="cb5-595"><a href="#cb5-595" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-X)</span></span>
<span id="cb5-596"><a href="#cb5-596" aria-hidden="true" tabindex="-1"></a><span class="co"># wide_norma4 &lt;- normalizeda4 |&gt;</span></span>
<span id="cb5-597"><a href="#cb5-597" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(cols = -Metabolite.name,</span></span>
<span id="cb5-598"><a href="#cb5-598" aria-hidden="true" tabindex="-1"></a><span class="co">#                names_to = "Sample",</span></span>
<span id="cb5-599"><a href="#cb5-599" aria-hidden="true" tabindex="-1"></a><span class="co">#                values_to = "Area"</span></span>
<span id="cb5-600"><a href="#cb5-600" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) |&gt;</span></span>
<span id="cb5-601"><a href="#cb5-601" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(Sample, Metabolite.name)|&gt;</span></span>
<span id="cb5-602"><a href="#cb5-602" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarize(Area = mean(Area),   </span></span>
<span id="cb5-603"><a href="#cb5-603" aria-hidden="true" tabindex="-1"></a><span class="co">#             .groups = "drop") |&gt;</span></span>
<span id="cb5-604"><a href="#cb5-604" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_wider(</span></span>
<span id="cb5-605"><a href="#cb5-605" aria-hidden="true" tabindex="-1"></a><span class="co">#     names_from  = Metabolite.name,</span></span>
<span id="cb5-606"><a href="#cb5-606" aria-hidden="true" tabindex="-1"></a><span class="co">#     values_from = Area</span></span>
<span id="cb5-607"><a href="#cb5-607" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb5-608"><a href="#cb5-608" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(wide_norma4, "wide_norma4.csv")</span></span>
<span id="cb5-609"><a href="#cb5-609" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-610"><a href="#cb5-610" aria-hidden="true" tabindex="-1"></a><span class="co"># normalizeda5&lt;-read.csv("normalized_a5.csv")|&gt;</span></span>
<span id="cb5-611"><a href="#cb5-611" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-X)</span></span>
<span id="cb5-612"><a href="#cb5-612" aria-hidden="true" tabindex="-1"></a><span class="co"># wide_norma5 &lt;- normalizeda5 |&gt;</span></span>
<span id="cb5-613"><a href="#cb5-613" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(cols = -Metabolite.name,</span></span>
<span id="cb5-614"><a href="#cb5-614" aria-hidden="true" tabindex="-1"></a><span class="co">#                names_to = "Sample",</span></span>
<span id="cb5-615"><a href="#cb5-615" aria-hidden="true" tabindex="-1"></a><span class="co">#                values_to = "Area"</span></span>
<span id="cb5-616"><a href="#cb5-616" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) |&gt;</span></span>
<span id="cb5-617"><a href="#cb5-617" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(Sample, Metabolite.name)|&gt;</span></span>
<span id="cb5-618"><a href="#cb5-618" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarize(Area = mean(Area),   </span></span>
<span id="cb5-619"><a href="#cb5-619" aria-hidden="true" tabindex="-1"></a><span class="co">#             .groups = "drop") |&gt;</span></span>
<span id="cb5-620"><a href="#cb5-620" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_wider(</span></span>
<span id="cb5-621"><a href="#cb5-621" aria-hidden="true" tabindex="-1"></a><span class="co">#     names_from  = Metabolite.name,</span></span>
<span id="cb5-622"><a href="#cb5-622" aria-hidden="true" tabindex="-1"></a><span class="co">#     values_from = Area</span></span>
<span id="cb5-623"><a href="#cb5-623" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb5-624"><a href="#cb5-624" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(wide_norma5, "wide_norma5.csv")</span></span>
<span id="cb5-625"><a href="#cb5-625" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-626"><a href="#cb5-626" aria-hidden="true" tabindex="-1"></a><span class="co"># normalizeda6&lt;-read.csv("normalized_a6.csv")|&gt;</span></span>
<span id="cb5-627"><a href="#cb5-627" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-X)</span></span>
<span id="cb5-628"><a href="#cb5-628" aria-hidden="true" tabindex="-1"></a><span class="co"># wide_norma6 &lt;- normalizeda6 |&gt;</span></span>
<span id="cb5-629"><a href="#cb5-629" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(cols = -Metabolite.name,</span></span>
<span id="cb5-630"><a href="#cb5-630" aria-hidden="true" tabindex="-1"></a><span class="co">#                names_to = "Sample",</span></span>
<span id="cb5-631"><a href="#cb5-631" aria-hidden="true" tabindex="-1"></a><span class="co">#                values_to = "Area"</span></span>
<span id="cb5-632"><a href="#cb5-632" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) |&gt;</span></span>
<span id="cb5-633"><a href="#cb5-633" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(Sample, Metabolite.name)|&gt;</span></span>
<span id="cb5-634"><a href="#cb5-634" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarize(Area = mean(Area),   </span></span>
<span id="cb5-635"><a href="#cb5-635" aria-hidden="true" tabindex="-1"></a><span class="co">#             .groups = "drop") |&gt;</span></span>
<span id="cb5-636"><a href="#cb5-636" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_wider(</span></span>
<span id="cb5-637"><a href="#cb5-637" aria-hidden="true" tabindex="-1"></a><span class="co">#     names_from  = Metabolite.name,</span></span>
<span id="cb5-638"><a href="#cb5-638" aria-hidden="true" tabindex="-1"></a><span class="co">#     values_from = Area</span></span>
<span id="cb5-639"><a href="#cb5-639" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb5-640"><a href="#cb5-640" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(wide_norma6, "wide_norma6.csv")</span></span>
<span id="cb5-641"><a href="#cb5-641" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-642"><a href="#cb5-642" aria-hidden="true" tabindex="-1"></a><span class="co"># normalizeda7&lt;-read.csv("normalized_a7.csv")|&gt;</span></span>
<span id="cb5-643"><a href="#cb5-643" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-X)</span></span>
<span id="cb5-644"><a href="#cb5-644" aria-hidden="true" tabindex="-1"></a><span class="co"># wide_norma7 &lt;- normalizeda7 |&gt;</span></span>
<span id="cb5-645"><a href="#cb5-645" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(cols = -Metabolite.name,</span></span>
<span id="cb5-646"><a href="#cb5-646" aria-hidden="true" tabindex="-1"></a><span class="co">#                names_to = "Sample",</span></span>
<span id="cb5-647"><a href="#cb5-647" aria-hidden="true" tabindex="-1"></a><span class="co">#                values_to = "Area"</span></span>
<span id="cb5-648"><a href="#cb5-648" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) |&gt;</span></span>
<span id="cb5-649"><a href="#cb5-649" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(Sample, Metabolite.name)|&gt;</span></span>
<span id="cb5-650"><a href="#cb5-650" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarize(Area = mean(Area),   </span></span>
<span id="cb5-651"><a href="#cb5-651" aria-hidden="true" tabindex="-1"></a><span class="co">#             .groups = "drop") |&gt;</span></span>
<span id="cb5-652"><a href="#cb5-652" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_wider(</span></span>
<span id="cb5-653"><a href="#cb5-653" aria-hidden="true" tabindex="-1"></a><span class="co">#     names_from  = Metabolite.name,</span></span>
<span id="cb5-654"><a href="#cb5-654" aria-hidden="true" tabindex="-1"></a><span class="co">#     values_from = Area</span></span>
<span id="cb5-655"><a href="#cb5-655" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb5-656"><a href="#cb5-656" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(wide_norma7, "wide_norma7.csv")</span></span>
<span id="cb5-657"><a href="#cb5-657" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-658"><a href="#cb5-658" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-659"><a href="#cb5-659" aria-hidden="true" tabindex="-1"></a><span class="co"># normalizeda8&lt;-read.csv("normalized_a8.csv")|&gt;</span></span>
<span id="cb5-660"><a href="#cb5-660" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-X)</span></span>
<span id="cb5-661"><a href="#cb5-661" aria-hidden="true" tabindex="-1"></a><span class="co"># wide_norma8 &lt;- normalizeda8 |&gt;</span></span>
<span id="cb5-662"><a href="#cb5-662" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(cols = -Metabolite.name,</span></span>
<span id="cb5-663"><a href="#cb5-663" aria-hidden="true" tabindex="-1"></a><span class="co">#                names_to = "Sample",</span></span>
<span id="cb5-664"><a href="#cb5-664" aria-hidden="true" tabindex="-1"></a><span class="co">#                values_to = "Area"</span></span>
<span id="cb5-665"><a href="#cb5-665" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) |&gt;</span></span>
<span id="cb5-666"><a href="#cb5-666" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(Sample, Metabolite.name)|&gt;</span></span>
<span id="cb5-667"><a href="#cb5-667" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarize(Area = mean(Area),   </span></span>
<span id="cb5-668"><a href="#cb5-668" aria-hidden="true" tabindex="-1"></a><span class="co">#             .groups = "drop") |&gt;</span></span>
<span id="cb5-669"><a href="#cb5-669" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_wider(</span></span>
<span id="cb5-670"><a href="#cb5-670" aria-hidden="true" tabindex="-1"></a><span class="co">#     names_from  = Metabolite.name,</span></span>
<span id="cb5-671"><a href="#cb5-671" aria-hidden="true" tabindex="-1"></a><span class="co">#     values_from = Area</span></span>
<span id="cb5-672"><a href="#cb5-672" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb5-673"><a href="#cb5-673" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(wide_norma9, "wide_norma.csv")</span></span>
<span id="cb5-674"><a href="#cb5-674" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-675"><a href="#cb5-675" aria-hidden="true" tabindex="-1"></a><span class="co"># normalizeda9&lt;-read.csv("normalized_a9.csv")|&gt;</span></span>
<span id="cb5-676"><a href="#cb5-676" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-X)</span></span>
<span id="cb5-677"><a href="#cb5-677" aria-hidden="true" tabindex="-1"></a><span class="co"># wide_norma9 &lt;- normalizeda9 |&gt;</span></span>
<span id="cb5-678"><a href="#cb5-678" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(cols = -Metabolite.name,</span></span>
<span id="cb5-679"><a href="#cb5-679" aria-hidden="true" tabindex="-1"></a><span class="co">#                names_to = "Sample",</span></span>
<span id="cb5-680"><a href="#cb5-680" aria-hidden="true" tabindex="-1"></a><span class="co">#                values_to = "Area"</span></span>
<span id="cb5-681"><a href="#cb5-681" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) |&gt;</span></span>
<span id="cb5-682"><a href="#cb5-682" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(Sample, Metabolite.name)|&gt;</span></span>
<span id="cb5-683"><a href="#cb5-683" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarize(Area = mean(Area),   </span></span>
<span id="cb5-684"><a href="#cb5-684" aria-hidden="true" tabindex="-1"></a><span class="co">#             .groups = "drop") |&gt;</span></span>
<span id="cb5-685"><a href="#cb5-685" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_wider(</span></span>
<span id="cb5-686"><a href="#cb5-686" aria-hidden="true" tabindex="-1"></a><span class="co">#     names_from  = Metabolite.name,</span></span>
<span id="cb5-687"><a href="#cb5-687" aria-hidden="true" tabindex="-1"></a><span class="co">#     values_from = Area</span></span>
<span id="cb5-688"><a href="#cb5-688" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb5-689"><a href="#cb5-689" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(wide_norma9, "wide_norma9.csv")</span></span>
<span id="cb5-690"><a href="#cb5-690" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-691"><a href="#cb5-691" aria-hidden="true" tabindex="-1"></a><span class="co"># normalizeda10&lt;-read.csv("normalized_a10.csv")|&gt;</span></span>
<span id="cb5-692"><a href="#cb5-692" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-X)</span></span>
<span id="cb5-693"><a href="#cb5-693" aria-hidden="true" tabindex="-1"></a><span class="co"># wide_norma10 &lt;- normalizeda10 |&gt;</span></span>
<span id="cb5-694"><a href="#cb5-694" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(cols = -Metabolite.name,</span></span>
<span id="cb5-695"><a href="#cb5-695" aria-hidden="true" tabindex="-1"></a><span class="co">#                names_to = "Sample",</span></span>
<span id="cb5-696"><a href="#cb5-696" aria-hidden="true" tabindex="-1"></a><span class="co">#                values_to = "Area"</span></span>
<span id="cb5-697"><a href="#cb5-697" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) |&gt;</span></span>
<span id="cb5-698"><a href="#cb5-698" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(Sample, Metabolite.name)|&gt;</span></span>
<span id="cb5-699"><a href="#cb5-699" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarize(Area = mean(Area),   </span></span>
<span id="cb5-700"><a href="#cb5-700" aria-hidden="true" tabindex="-1"></a><span class="co">#             .groups = "drop") |&gt;</span></span>
<span id="cb5-701"><a href="#cb5-701" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_wider(</span></span>
<span id="cb5-702"><a href="#cb5-702" aria-hidden="true" tabindex="-1"></a><span class="co">#     names_from  = Metabolite.name,</span></span>
<span id="cb5-703"><a href="#cb5-703" aria-hidden="true" tabindex="-1"></a><span class="co">#     values_from = Area</span></span>
<span id="cb5-704"><a href="#cb5-704" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb5-705"><a href="#cb5-705" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(wide_norma10, "wide_norma10.csv")</span></span>
<span id="cb5-706"><a href="#cb5-706" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-707"><a href="#cb5-707" aria-hidden="true" tabindex="-1"></a><span class="co"># normalizeda11&lt;-read.csv("normalized_a11.csv")|&gt;</span></span>
<span id="cb5-708"><a href="#cb5-708" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-X)</span></span>
<span id="cb5-709"><a href="#cb5-709" aria-hidden="true" tabindex="-1"></a><span class="co"># wide_norma11 &lt;- normalizeda11 |&gt;</span></span>
<span id="cb5-710"><a href="#cb5-710" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(cols = -Metabolite.name,</span></span>
<span id="cb5-711"><a href="#cb5-711" aria-hidden="true" tabindex="-1"></a><span class="co">#                names_to = "Sample",</span></span>
<span id="cb5-712"><a href="#cb5-712" aria-hidden="true" tabindex="-1"></a><span class="co">#                values_to = "Area"</span></span>
<span id="cb5-713"><a href="#cb5-713" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) |&gt;</span></span>
<span id="cb5-714"><a href="#cb5-714" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(Sample, Metabolite.name)|&gt;</span></span>
<span id="cb5-715"><a href="#cb5-715" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarize(Area = mean(Area),   </span></span>
<span id="cb5-716"><a href="#cb5-716" aria-hidden="true" tabindex="-1"></a><span class="co">#             .groups = "drop") |&gt;</span></span>
<span id="cb5-717"><a href="#cb5-717" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_wider(</span></span>
<span id="cb5-718"><a href="#cb5-718" aria-hidden="true" tabindex="-1"></a><span class="co">#     names_from  = Metabolite.name,</span></span>
<span id="cb5-719"><a href="#cb5-719" aria-hidden="true" tabindex="-1"></a><span class="co">#     values_from = Area</span></span>
<span id="cb5-720"><a href="#cb5-720" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb5-721"><a href="#cb5-721" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(wide_norma11, "wide_norma11.csv")</span></span>
<span id="cb5-722"><a href="#cb5-722" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-723"><a href="#cb5-723" aria-hidden="true" tabindex="-1"></a><span class="co"># normalizeda12&lt;-read.csv("normalized_a12.csv")|&gt;</span></span>
<span id="cb5-724"><a href="#cb5-724" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-X)</span></span>
<span id="cb5-725"><a href="#cb5-725" aria-hidden="true" tabindex="-1"></a><span class="co"># wide_norma12 &lt;- normalizeda12 |&gt;</span></span>
<span id="cb5-726"><a href="#cb5-726" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(cols = -Metabolite.name,</span></span>
<span id="cb5-727"><a href="#cb5-727" aria-hidden="true" tabindex="-1"></a><span class="co">#                names_to = "Sample",</span></span>
<span id="cb5-728"><a href="#cb5-728" aria-hidden="true" tabindex="-1"></a><span class="co">#                values_to = "Area"</span></span>
<span id="cb5-729"><a href="#cb5-729" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) |&gt;</span></span>
<span id="cb5-730"><a href="#cb5-730" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(Sample, Metabolite.name)|&gt;</span></span>
<span id="cb5-731"><a href="#cb5-731" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarize(Area = mean(Area),   </span></span>
<span id="cb5-732"><a href="#cb5-732" aria-hidden="true" tabindex="-1"></a><span class="co">#             .groups = "drop") |&gt;</span></span>
<span id="cb5-733"><a href="#cb5-733" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_wider(</span></span>
<span id="cb5-734"><a href="#cb5-734" aria-hidden="true" tabindex="-1"></a><span class="co">#     names_from  = Metabolite.name,</span></span>
<span id="cb5-735"><a href="#cb5-735" aria-hidden="true" tabindex="-1"></a><span class="co">#     values_from = Area</span></span>
<span id="cb5-736"><a href="#cb5-736" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb5-737"><a href="#cb5-737" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(wide_norma12, "wide_norma12.csv")</span></span>
<span id="cb5-738"><a href="#cb5-738" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-739"><a href="#cb5-739" aria-hidden="true" tabindex="-1"></a><span class="co"># normalizeda13&lt;-read.csv("normalized_a13.csv")|&gt;</span></span>
<span id="cb5-740"><a href="#cb5-740" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-X)</span></span>
<span id="cb5-741"><a href="#cb5-741" aria-hidden="true" tabindex="-1"></a><span class="co"># wide_norma13 &lt;- normalizeda13 |&gt;</span></span>
<span id="cb5-742"><a href="#cb5-742" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(cols = -Metabolite.name,</span></span>
<span id="cb5-743"><a href="#cb5-743" aria-hidden="true" tabindex="-1"></a><span class="co">#                names_to = "Sample",</span></span>
<span id="cb5-744"><a href="#cb5-744" aria-hidden="true" tabindex="-1"></a><span class="co">#                values_to = "Area"</span></span>
<span id="cb5-745"><a href="#cb5-745" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) |&gt;</span></span>
<span id="cb5-746"><a href="#cb5-746" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(Sample, Metabolite.name)|&gt;</span></span>
<span id="cb5-747"><a href="#cb5-747" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarize(Area = mean(Area),   </span></span>
<span id="cb5-748"><a href="#cb5-748" aria-hidden="true" tabindex="-1"></a><span class="co">#             .groups = "drop") |&gt;</span></span>
<span id="cb5-749"><a href="#cb5-749" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_wider(</span></span>
<span id="cb5-750"><a href="#cb5-750" aria-hidden="true" tabindex="-1"></a><span class="co">#     names_from  = Metabolite.name,</span></span>
<span id="cb5-751"><a href="#cb5-751" aria-hidden="true" tabindex="-1"></a><span class="co">#     values_from = Area</span></span>
<span id="cb5-752"><a href="#cb5-752" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb5-753"><a href="#cb5-753" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(wide_norma13, "wide_norma13.csv")</span></span>
<span id="cb5-754"><a href="#cb5-754" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-755"><a href="#cb5-755" aria-hidden="true" tabindex="-1"></a><span class="co"># normalizeda14&lt;-read.csv("normalized_a14.csv")|&gt;</span></span>
<span id="cb5-756"><a href="#cb5-756" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-X)</span></span>
<span id="cb5-757"><a href="#cb5-757" aria-hidden="true" tabindex="-1"></a><span class="co"># wide_norma14 &lt;- normalizeda14 |&gt;</span></span>
<span id="cb5-758"><a href="#cb5-758" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(cols = -Metabolite.name,</span></span>
<span id="cb5-759"><a href="#cb5-759" aria-hidden="true" tabindex="-1"></a><span class="co">#                names_to = "Sample",</span></span>
<span id="cb5-760"><a href="#cb5-760" aria-hidden="true" tabindex="-1"></a><span class="co">#                values_to = "Area"</span></span>
<span id="cb5-761"><a href="#cb5-761" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) |&gt;</span></span>
<span id="cb5-762"><a href="#cb5-762" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(Sample, Metabolite.name)|&gt;</span></span>
<span id="cb5-763"><a href="#cb5-763" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarize(Area = mean(Area),   </span></span>
<span id="cb5-764"><a href="#cb5-764" aria-hidden="true" tabindex="-1"></a><span class="co">#             .groups = "drop") |&gt;</span></span>
<span id="cb5-765"><a href="#cb5-765" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_wider(</span></span>
<span id="cb5-766"><a href="#cb5-766" aria-hidden="true" tabindex="-1"></a><span class="co">#     names_from  = Metabolite.name,</span></span>
<span id="cb5-767"><a href="#cb5-767" aria-hidden="true" tabindex="-1"></a><span class="co">#     values_from = Area</span></span>
<span id="cb5-768"><a href="#cb5-768" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb5-769"><a href="#cb5-769" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(wide_norma14, "wide_norma14.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, I merged all these datasets to make a PCA. I also matched the sample id to the bacteria class, referencing Han et al, (2021)</p>
<p>Here is the example code of me pivoting the data and then matching the names to the phylum class and order</p>
<p>#reading in wide dfs for han et al wide_norma1&lt;-read.csv( “wide_norma1.csv”)|&gt; select(-X)</p>
<p>wide_norma2&lt;-read.csv( “wide_norma2.csv”)|&gt; select(-X)</p>
<p>wide_norma3&lt;-read.csv( “wide_norma3.csv”)|&gt; select(-X)</p>
<p>wide_norma4&lt;-read.csv( “wide_norma4.csv”)|&gt; select(-X)</p>
<p>wide_norma5&lt;-read.csv( “wide_norma5.csv”)|&gt; select(-X)</p>
<p>wide_norma6&lt;-read.csv( “wide_norma6.csv”)|&gt; select(-X)</p>
<p>wide_norma7&lt;-read.csv( “wide_norma7.csv”)|&gt; select(-X)</p>
<p>wide_norma8&lt;-read.csv( “wide_norma8.csv”)|&gt; select(-X)</p>
<p>wide_norma9&lt;-read.csv( “wide_norma9.csv”)|&gt; select(-X)</p>
<p>wide_norma10&lt;-read.csv( “wide_norma10.csv”)|&gt; select(-X)</p>
<p>wide_norma11&lt;-read.csv( “wide_norma11.csv”)|&gt; select(-X)</p>
<p>wide_norma12&lt;-read.csv( “wide_norma12.csv”)|&gt; select(-X)</p>
<p>wide_norma13&lt;-read.csv( “wide_norma13.csv”)|&gt; select(-X)</p>
<p>wide_norma14&lt;-read.csv( “wide_norma14.csv”)|&gt; select(-X)</p>
<p>wide_combined&lt;-wide_norma1|&gt; bind_rows(wide_norma2, wide_norma3, wide_norma4, wide_norma5, wide_norma6, wide_norma7, wide_norma8, wide_norma9, wide_norma10, wide_norma11, wide_norma12, wide_norma13, wide_norma14)|&gt; mutate(across(everything(), ~replace_na(.x, 0)))|&gt; distinct(Sample, .keep_all = TRUE)</p>
<p>library(rvest) library(tidytext) url &lt;- “<a href="https://www.metabolomicsworkbench.org/data/subject_fetch.php?STUDY_ID=ST001688&amp;STUDY_TYPE=MS&amp;RESULT_TYPE=1%22">https://www.metabolomicsworkbench.org/data/subject_fetch.php?STUDY_ID=ST001688&amp;STUDY_TYPE=MS&amp;RESULT_TYPE=1”</a></p>
<p>names&lt;-url |&gt; read_html() |&gt; html_elements(“table”) %&gt;% .[[2]] |&gt; html_table()|&gt; select(<code>Sample name</code>, phylum, class, order) joined_data1&lt;-wide_combined|&gt; left_join(names, by = c(“Sample” = “Sample name”))</p>
<p>#now my data wide_norm_myms&lt;-read.csv(“wide_norm_myms.csv”)|&gt; select(-X) |&gt; mutate(Sample = gsub(“\.”, ” “, Sample))</p>
<p>ID_samples&lt;-read.csv(“guide to txt names.csv”)|&gt; filter(Name !=“Blank_A”, Name != “Blank_B” ) my_jd&lt;-wide_norm_myms|&gt; left_join(ID_samples, by = c(“Sample” = “Name”) )</p>
<p>full_jd&lt;-my_jd|&gt; bind_rows(joined_data1)|&gt; mutate(across(everything(), ~replace_na(.x, 0)))|&gt; distinct(Sample, .keep_all = TRUE)</p>
<p>write.csv(full_jd, “full_jd.csv”)</p>
<p>Now we run PCA!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'caret'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    lift</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ranger)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>full_jd<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"~/Desktop/biochem csvs/full_jd.csv"</span>)<span class="sc">|&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>X)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>full_jd<span class="ot">&lt;-</span>full_jd<span class="sc">|&gt;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(phylum <span class="sc">!=</span> <span class="st">"broth"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>         phylum <span class="sc">!=</span> <span class="st">"IS"</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>         phylum <span class="sc">!=</span> <span class="st">"-"</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>names_df<span class="ot">&lt;-</span>full_jd<span class="sc">|&gt;</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(phylum, class, order, Sample)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>metabolite_df<span class="ot">&lt;-</span>full_jd<span class="sc">|&gt;</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>phylum, <span class="sc">-</span>class, <span class="sc">-</span>order, <span class="sc">-</span>Sample)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>scaled_mdf <span class="ot">&lt;-</span> metabolite_df<span class="sc">|&gt;</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(<span class="sc">~</span> <span class="fu">var</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">!=</span> <span class="dv">0</span>))<span class="sc">|&gt;</span>   </span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()<span class="sc">|&gt;</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(scaled_mdf) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">."</span>, <span class="st">" "</span>, <span class="fu">names</span>(scaled_mdf))</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>pca_1 <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(scaled_mdf, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>stdev<span class="ot">&lt;-</span>pca_1<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>pca_var_explained <span class="ot">&lt;-</span> stdev<span class="sc">/</span><span class="fu">sum</span>(stdev)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pca_var_explained, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.19031123 0.14052878 0.12927749 0.05932754 0.04731732 0.03571289
 [7] 0.03257176 0.01879651 0.01759789 0.01581721</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#test</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>pca_all <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(scaled_mdf, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n_PC =</span> <span class="fu">integer</span>(), <span class="at">Accuracy =</span> <span class="fu">double</span>())</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> full_jd<span class="sc">$</span>class</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>({</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Running for"</span>, k, <span class="st">"PCs...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  pc_data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pca_all<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span>k])</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  pc_data<span class="sc">$</span>class <span class="ot">&lt;-</span> labels</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  tunegrid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">mtry =</span> <span class="dv">1</span><span class="sc">:</span>k,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">splitrule =</span> <span class="st">"gini"</span>,</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">min.node.size =</span> <span class="dv">1</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    class <span class="sc">~</span> .,</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pc_data,</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"ranger"</span>,</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>),</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">tuneGrid =</span> tunegrid,</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">importance =</span> <span class="st">"impurity"</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  best_acc <span class="ot">&lt;-</span> <span class="fu">max</span>(model<span class="sc">$</span>results<span class="sc">$</span>Accuracy)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, <span class="fu">data.frame</span>(<span class="at">n_PC =</span> k, <span class="at">Accuracy =</span> best_acc))</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Finished k ="</span>, k, <span class="st">"with Accuracy ="</span>, <span class="fu">round</span>(best_acc, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running for 1 PCs...
Finished k = 1 with Accuracy = 0.2278 
Running for 2 PCs...
Finished k = 2 with Accuracy = 0.3823 
Running for 3 PCs...
Finished k = 3 with Accuracy = 0.3933 
Running for 4 PCs...
Finished k = 4 with Accuracy = 0.4832 
Running for 5 PCs...
Finished k = 5 with Accuracy = 0.5443 
Running for 6 PCs...
Finished k = 6 with Accuracy = 0.6146 
Running for 7 PCs...
Finished k = 7 with Accuracy = 0.6259 
Running for 8 PCs...
Finished k = 8 with Accuracy = 0.6473 
Running for 9 PCs...
Finished k = 9 with Accuracy = 0.6736 
Running for 10 PCs...
Finished k = 10 with Accuracy = 0.6769 
Running for 11 PCs...
Finished k = 11 with Accuracy = 0.6781 
Running for 12 PCs...
Finished k = 12 with Accuracy = 0.7017 
Running for 13 PCs...
Finished k = 13 with Accuracy = 0.6917 
Running for 14 PCs...
Finished k = 14 with Accuracy = 0.696 
Running for 15 PCs...
Finished k = 15 with Accuracy = 0.7156 
Running for 16 PCs...
Finished k = 16 with Accuracy = 0.7097 
Running for 17 PCs...
Finished k = 17 with Accuracy = 0.7201 
Running for 18 PCs...
Finished k = 18 with Accuracy = 0.7018 
Running for 19 PCs...
Finished k = 19 with Accuracy = 0.7369 
Running for 20 PCs...
Finished k = 20 with Accuracy = 0.7212 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#19 PCs has most accuracy, so using 19PCs in model</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#now doing an initial model before tuning</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#extracting metabolites from the most important PC (PC9)</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>important_metabolites<span class="ot">&lt;-</span>pca_1<span class="sc">$</span>rotation <span class="sc">|&gt;</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(PC9) <span class="sc">|&gt;</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(PC9)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>joined_PCs <span class="ot">&lt;-</span> full_jd<span class="sc">|&gt;</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PC1 =</span> pca_1<span class="sc">$</span>x[,<span class="dv">1</span>],</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">PC2 =</span> pca_1<span class="sc">$</span>x[,<span class="dv">2</span>],</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">PC3 =</span> pca_1<span class="sc">$</span>x[,<span class="dv">3</span>],</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">PC4 =</span> pca_1<span class="sc">$</span>x[,<span class="dv">4</span>],</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">PC5 =</span> pca_1<span class="sc">$</span>x[,<span class="dv">5</span>],</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">PC6 =</span> pca_1<span class="sc">$</span>x[,<span class="dv">6</span>],</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">PC7 =</span> pca_1<span class="sc">$</span>x[,<span class="dv">7</span>],</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">PC8 =</span> pca_1<span class="sc">$</span>x[,<span class="dv">8</span>],</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">PC9 =</span> pca_1<span class="sc">$</span>x[,<span class="dv">9</span>],</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">PC10 =</span> pca_1<span class="sc">$</span>x[,<span class="dv">10</span>],</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">PC11 =</span> pca_1<span class="sc">$</span>x[,<span class="dv">11</span>],</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">PC12 =</span> pca_1<span class="sc">$</span>x[,<span class="dv">12</span>],</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">PC13 =</span> pca_1<span class="sc">$</span>x[,<span class="dv">13</span>],</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">PC14 =</span> pca_1<span class="sc">$</span>x[,<span class="dv">14</span>],</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">PC15 =</span> pca_1<span class="sc">$</span>x[,<span class="dv">15</span>],</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">PC16 =</span> pca_1<span class="sc">$</span>x[,<span class="dv">16</span>],</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">PC17 =</span> pca_1<span class="sc">$</span>x[,<span class="dv">17</span>],</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">PC18 =</span> pca_1<span class="sc">$</span>x[,<span class="dv">18</span>],</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">PC19 =</span> pca_1<span class="sc">$</span>x[,<span class="dv">19</span>])<span class="sc">|&gt;</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Sample, phylum, class, order, PC1, PC2, PC3, PC4, PC5, PC6, PC7,</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>         PC8, PC9, PC10, PC11, PC12, PC13, PC14,PC15, PC16, PC17, PC18, PC19)</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(joined_PCs, <span class="st">"Joined_PC_df.csv"</span>)</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>joined_PCs<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"~/Desktop/biochem csvs/Joined_PC_df.csv"</span>)<span class="sc">|&gt;</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>X)<span class="sc">|&gt;</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(phylum <span class="sc">!=</span> <span class="st">"broth"</span>,</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>         phylum <span class="sc">!=</span> <span class="st">"IS"</span>,</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>         phylum <span class="sc">!=</span> <span class="st">"-"</span>)</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(prodlim)</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a><span class="co">#now implementing tuning parameters</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>tune_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">mtry =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>),</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>                         <span class="at">splitrule =</span> <span class="st">"extratrees"</span>,</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>                         <span class="at">min.node.size =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a><span class="co">#now testing on my own bacteria</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>known_df <span class="ot">&lt;-</span> joined_PCs <span class="sc">|&gt;</span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sample <span class="sc">!=</span> <span class="st">"Gen 1 1_1"</span>,</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>         Sample <span class="sc">!=</span> <span class="st">"Gen 1 1_2 rerun"</span>,</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>         Sample <span class="sc">!=</span> <span class="st">"Gen 1 2_1"</span>,</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>         Sample <span class="sc">!=</span> <span class="st">"Gen 1 2_2 rerun"</span>)</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>unknown_df <span class="ot">&lt;-</span> joined_PCs <span class="sc">|&gt;</span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sample <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Gen 1 1_1"</span>, <span class="st">"Gen 1 1_2 rerun"</span>,<span class="st">"Gen 1 2_1"</span>,</span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Gen 1 2_2 rerun"</span>))</span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>({</span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">train</span>(class <span class="sc">~</span> .,</span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> known_df <span class="sc">|&gt;</span></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">select</span>(<span class="sc">-</span>Sample, <span class="sc">-</span>phylum, <span class="sc">-</span>order),</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>                <span class="at">method =</span> <span class="st">"ranger"</span>,</span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>                <span class="at">tuneGrid =</span> tune_grid,</span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>                <span class="at">importance =</span> <span class="st">"impurity"</span>, </span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>                <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>))</span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>model3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Random Forest 

878 samples
 19 predictor
 14 classes: 'Actinobacteria', 'Actinomycetia', 'Bacilli', 'Bacteroidia', 'Betaproteobacteria', 'Clostridia', 'Coriobacteriia', 'Deltaproteobacteria', 'Erysipelotrichia', 'Fusobacteriia', 'Gammaproteobacteria', 'Negativicutes', 'Tissierellia', 'Verrucomicrobiae' 

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 705, 701, 701, 702, 703 
Resampling results across tuning parameters:

  mtry  min.node.size  Accuracy   Kappa    
   8    1              0.7221128  0.6241110
   8    2              0.7221844  0.6248874
   8    3              0.7187291  0.6185828
   9    1              0.7266842  0.6307416
   9    2              0.7232099  0.6256296
   9    3              0.7164566  0.6151977
  10    1              0.7266452  0.6304151
  10    2              0.7210288  0.6227495
  10    3              0.7198659  0.6198279

Tuning parameter 'splitrule' was held constant at a value of extratrees
Accuracy was used to select the optimal model using the largest value.
The final values used for the model were mtry = 9, splitrule = extratrees
 and min.node.size = 1.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ranger variable importance

     Overall
PC9  100.000
PC8   70.681
PC18  57.755
PC15  50.670
PC19  49.920
PC12  48.023
PC17  47.988
PC5   46.689
PC4   35.486
PC14  33.213
PC7   29.826
PC13  29.644
PC6   27.221
PC10  26.530
PC11  20.715
PC16  19.298
PC1    5.078
PC3    4.729
PC2    0.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot PC9 and PC15, 2 important components</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>known_df<span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> PC8, <span class="at">y =</span> PC9, <span class="at">color =</span> class), <span class="at">size =</span> <span class="dv">2</span> ,<span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span>  </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC8"</span>),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"PC9"</span>)) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="cn">NA</span>),   </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="cn">NA</span>),   </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.3</span>),</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Quartz-file-for-project_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>unknown_preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(model3, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">newdata =</span> unknown_df <span class="sc">|&gt;</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">select</span>(<span class="sc">-</span>Sample, <span class="sc">-</span>phylum, <span class="sc">-</span>order))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(unknown_preds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Bacilli       Bacilli       Bacilli       Actinomycetia
14 Levels: Actinobacteria Actinomycetia Bacilli ... Verrucomicrobiae</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>unknown_df<span class="sc">$</span>predicted_class <span class="ot">&lt;-</span> unknown_preds</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(joined_PCs<span class="sc">$</span>class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Actinobacteria       Actinomycetia             Bacilli         Bacteroidia 
                 45                   4                  89                 249 
 Betaproteobacteria          Clostridia      Coriobacteriia Deltaproteobacteria 
                  4                 305                  24                  12 
   Erysipelotrichia       Fusobacteriia Gammaproteobacteria       Negativicutes 
                  6                  14                  77                  42 
       Tissierellia    Verrucomicrobiae 
                  8                   3 </code></pre>
</div>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>